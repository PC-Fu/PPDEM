<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>





	<title>CodeProject: ColorMatrix Basics - Simple Image Color Adjustment. Free source code and programming help</title> 
	<link type="text/css" rel="stylesheet" href="colormatrix.aspx_files/CodeProject.css">
<link type="text/css" rel="stylesheet" href="colormatrix.aspx_files/ForumClassic.css">
<style type="text/css">
#ATD {position: absolute;top: -90px;left: -5000px;z-index: 200;display: none;white-space:nowrap;background-color:white;padding:10px;border: solid 1px #999;}

</style>


	
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Description" content="A beginners guide to using the GDI+ ColorMatrix.; Author: Michael Combs; Section: GDI+; Chapter: Multimedia">
<meta name="Keywords" content="VB, Windows, .NET, Visual Studio, Dev, Beginner,GDI+,Multimedia,Free source code, tutorials">
<meta name="Author" content="The Code Project">
<meta name="Rating" content="General">
<meta name="Robots" content="index, follow">
<meta name="Revisit-After" content="1 days">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All topics" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - MFC / C++" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C#" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - ASP.NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - .NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - VB.NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="http://www.codeproject.com/webservices/LoungeRSS.aspx">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="http://www.codeproject.com/info/OpenSearch.xml">
	<!-- base -->
	<link rel="icon" href="http://www.codeproject.com/favicon.ico" type="image/ico">
<link rel="shortcut icon" href="http://www.codeproject.com/favicon.ico" type="image/ico">
<script type="text/javascript" language="Javascript" src="colormatrix.aspx_files/jquery-1.js"></script>
<script type="text/javascript" language="Javascript" src="colormatrix.aspx_files/ShortCuts.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
function LK(e) { var lounge  = document.getElementById("ctl00_TopNavBar_Lounge"); var soapbox = document.getElementById("ctl00_TopNavBar_Soapbox"); if (lounge && soapbox) {   lounge.style.display = e.ctrlKey? "none" : "inline";  soapbox.style.display = e.ctrlKey? "inline" : "none"; }}
function LC(e) {
 window.location.href = e.ctrlKey ? '/script/Forums/View.aspx?fid=1536756':'/Lounge.aspx';
 if (document.all) e.returnValue = false; else e.preventDefault();
}
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

function ChkRtctl00_RateArticle(val, objId) {if (val<=2) {$('div[name=RateItem_' + objId + '] .RateComDiv').css("display","");}else $('div[name=RateItem_' + objId + '] .RateComDiv').css("display","none");}
var Selected = "-1";
function Pin(elm){
 CloseMsg(Selected);
 var wrk=elm.parentNode; if(wrk)wrk=wrk.firstChild;
 var fc=elm?elm.firstChild:null;
 if (wrk&&!wrk.pinned) {
  OpenMsg(wrk.name, true);wrk.pinned=true;fc.src='/script/forums/images/pinned.gif';fc.title='Pinned. Click to unpin'
 } else {
  wrk.pinned=false;CloseMsg(wrk.name); fc.src='/script/forums/images/pin.gif';fc.title='Click to pin message'
 }
 return false;
}
function CloseMsg(msgId) {
 if(!msgId||(msgId==''))return;
 var lnk=document.getElementsByName(msgId);
 if(lnk&&lnk.length>0&&lnk[0].pinned)return;
 var head=eval("document.getElementById('F" + msgId + "_h0')");
 if(head) head.className = head.className.replace("Sel", "UnSel");
 var body=eval("document.getElementById('F" + msgId + "_h1')");
 if(body) body.style.display = 'none';
}
function OpenMsg(msgId, keep) {
 if(!msgId||(msgId==''))return;
 var body=eval("document.getElementById('F" + msgId + "_h1')");
 if(body){
  var lnk=document.getElementsByName(msgId);
  if(lnk&&lnk.length>0&&lnk[0].pinned)keep=true;
  if(keep&&body.style.display!='none')return;
  if(body.style.display=='none') body.style.display='';
  else body.style.display = 'none';
 }
 var head=eval("document.getElementById('F" + msgId + "_h0')");
 if (head) head.className = head.className.replace('UnSel', 'Sel');
 if(body&&head&&body.style.display!='none'){
  document.body.scrollTop = getRealPos(head, 'Top') - document.body.clientHeight/10;
  EnsureMessageVisible(msgId, true);
 }
}

function SwitchMessage(e, msgId)
{
  if (msgId) msgId=msgId.toString();
  else {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    if(target.pinned){Selected='';return false;}
    msgId=target.name;
  }
  CloseMsg(Selected)
  if(Selected==msgId) Selected='';
  else { OpenMsg(msgId, false); Selected=msgId;}
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}


//]]></script>

	
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="colormatrix.aspx_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
if (typeof(_gat) != "undefined" && _gat)
{ 
	var pageTracker = _gat._getTracker("UA-1735123-1");
	pageTracker._setDomainName("www.codeproject.com");
	pageTracker._setSessionTimeout("1200"); // 20 mins
	pageTracker._initData();
	pageTracker._trackPageview();
}
</script>
</head><body>

<a href="#Main"><img alt="Click here to Skip to main content" src="colormatrix.aspx_files/t.gif" style="border-style: none; position: absolute; top: 0pt; left: 0pt; width: 1px; height: 1px; z-index: 100;"></a>

<div style="margin: 0px; padding: 0px; width: 100%;">
	<div style="width: 100%;">

<table class="MemberNavBar" cellpadding="5" cellspacing="0" width="100%">
<tbody><tr>
<td style="font-weight: bold;">6,657,473 members and growing! (21,441 online)</td>
<td align="right">



<div id="ctl00_MemberMenu_LoggedOffOptions" class="MemberNavBarText" style="margin: 0pt; padding: 0pt;">
	<a name="SignUp"></a>
<form name="subForm" id="subForm" action="/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx" method="post" style="margin: 0pt; padding: 0pt;">

<!-- This hidden field is used for identifying form which has made post request.
     (This form posts to another page and we need to know which form did the post request) -->
<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

Email    <input class="SmallText" name="Email" id="Email" style="width: 100px;" type="text">
Password <input class="SmallText" name="Password" id="Password" style="width: 60px;" type="password">
<input value="Sign in" class="FormButton" type="submit">
<script type="text/javascript">
function Join(){document.location.href='/script/Membership/Modify.aspx';return false;}
document.write('<input type="button" class="FormButton" onclick="return Join();" value="Join"');
document.write('<input type="hidden" name="fld_quicksign" value="true" />');
</script><input class="FormButton" onclick="return Join();" value="Join" type="button"><input name="fld_quicksign" value="true" type="hidden">
<input checked="checked" name="RememberMeCheck" id="RememberMeCheck" value="1" type="checkbox">
<label for="RememberMeCheck">Remember me?</label>&nbsp;
<a id="ctl00_MemberMenu_SendPassword" href="http://www.codeproject.com/script/Membership/SendPassword.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx"><img alt="help" src="colormatrix.aspx_files/help.gif" align="middle" border="0" height="16px" width="16px">Lost your password?</a>
</form>

</div>

</td>
</tr>
</tbody></table></div>
	<table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr>
		<td class="HeaderLogo"><a href="http://www.codeproject.com/"><img id="ctl00_Logo" src="colormatrix.aspx_files/logo225x90.gif" alt="The Code Project" style="border-width: 0px; height: 90px; width: 225px;"></a></td>				 
		<td class="HeaderBanner" align="right" width="100%"><iframe src="colormatrix.aspx_files/ServeFlash.htm" scrolling="no" frameborder="0" height="90px" width="728px"></iframe></td>
	</tr></tbody></table>
	

<div class="NavBarMain">
<ul id="nav">

<li><a href="http://www.codeproject.com/">Home</a></li>
<li><a id="ctl00_TopNavBar_Art" class="down" href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</a>



	<ul class="flyout">
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="http://www.codeproject.com/info/search.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="http://www.codeproject.com/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="http://www.codeproject.com/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=4">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="http://www.codeproject.com/info/search.aspx?vidlst=152&amp;sa_us=True">Beginner Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="http://www.codeproject.com/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly" href="http://www.codeproject.com/info/Submit.aspx">Post an Article</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostTipTrick" class="fly" href="http://www.codeproject.com/script/Answers/Post.aspx?new=tipntrick">Post Tip/Trick</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly break" href="http://www.codeproject.com/script/Articles/BlogFeed.aspx">Post your Blog</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="http://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly" href="http://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article Competition</a></li>
		<li><a id="ctl00_TopNavBar_ArtTopicList" class="last" href="http://www.codeproject.com/script/Content/SiteMap.aspx">Topic List</a></li>
	</ul>

</li>



<li><a id="ctl00_TopNavBar_Answers" href="http://www.codeproject.com/script/Answers/">Quick Answers</a>
	<ul class="flyout">
		<li><a id="ctl00_TopNavBar_QAAsk" class="fly" href="http://www.codeproject.com/script/Answers/Post.aspx?new=question">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_QASearch" class="fly" href="http://www.codeproject.com/info/search.aspx">Search for an Answer</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest">Latest Questions</a></li>
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="http://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QATop" class="fly" href="http://www.codeproject.com/script/Answers/List.aspx?tab=toprated">Top Questions</a></li>
		<li><a id="ctl00_TopNavBar_QAFaq" class="last" href="http://www.codeproject.com/script/Answers/FAQ.aspx">Help! (our FAQ)</a></li>
	</ul>

</li>



<li><a id="ctl00_TopNavBar_MessageBoards" class="down" href="http://www.codeproject.com/script/Forums/List.aspx">Message Boards</a>

	<ul class="flyout">
		<li><a class="fly" href="http://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1648/COM.aspx">COM</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1004117/LINQ.aspx">LINQ</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1004257/Silverlight.aspx">Silverlight</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1725/General-Database.aspx">General Database</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1540733/Sharepoint.aspx">Sharepoint</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1004114/WPF-WCF-WF.aspx">WPF / WCF / WF</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/3421/XML-XSL.aspx">XML / XSL</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1642/General-IT-Issues.aspx">General IT Issues</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx">Site Bugs / Suggestions</a></li>
<li><a class="fly" href="http://www.codeproject.com/Forums/1536756/The-Soapbox-2-0.aspx">The Soapbox 2.0</a></li>

		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="last" href="http://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
	</ul>

</li>



<li><a id="ctl00_TopNavBar_Job" href="http://www.codeproject.com/script/Jobs/List.aspx">Job Board</a>
	<ul class="flyout">
		<li><a id="ctl00_TopNavBar_JobLatest" class="fly" href="http://www.codeproject.com/script/Jobs/List.aspx">Latest</a></li>
		<li><a id="ctl00_TopNavBar_JobSearch" class="fly" href="http://www.codeproject.com/script/Jobs/Search.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_JobPost" class="fly" href="http://www.codeproject.com/script/Jobs/Edit.aspx">Post a Job</a></li>
		<li><a id="ctl00_TopNavBar_JobFaq" class="last" href="http://www.codeproject.com/script/Jobs/FAQ.aspx">FAQ and Pricing</a></li>
	</ul>

</li>




<li><a id="ctl00_TopNavBar_Cat" href="http://www.codeproject.com/script/Catalog/List.aspx">Catalog</a>
	<ul class="flyout">
		<li><a id="ctl00_TopNavBar_CatLatest" class="fly" href="http://www.codeproject.com/script/Catalog/List.aspx?ctls=DatePostedDescending">Latest</a></li>
		<li><a id="ctl00_TopNavBar_CatSearch" class="fly" href="http://www.codeproject.com/script/Catalog/List.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_CatPost" class="fly" href="http://www.codeproject.com/script/Catalog/Edit.aspx">Post a Catalog Item</a></li>
		<li><a id="ctl00_TopNavBar_CatFaq" class="last" href="http://www.codeproject.com/script/Catalog/FAQ.aspx">FAQ and Pricing</a></li>
	</ul>

</li>






<li><a id="ctl00_TopNavBar_Help" href="http://www.codeproject.com/info/FAQ.aspx">Help!</a>

	<ul class="flyout">
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="http://www.codeproject.com/info/guide.aspx">What is 'The Code Project'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly" href="http://www.codeproject.com/info/FAQ.aspx">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly" href="http://www.codeproject.com/script/Forums/List.aspx">Post a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="http://www.codeproject.com/script/Content/SiteMap.aspx">Site Directory</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="last" href="http://www.codeproject.com/info/about.aspx">About Us</a></li>
	</ul>

</li>


<li style="float: right;">
<a id="ctl00_TopNavBar_Lounge" href="http://www.codeproject.com/Lounge.aspx">Lounge</a>
<a id="ctl00_TopNavBar_Soapbox" href="javascript:void();" style="display: none;">Soapbox</a>

</li>

</ul>

</div>
	<div style="width: 100%;"><a name="_top"></a><table id="ctl00_ArticleTopHeader_HeaderTable" class="ArticleHeader" cellpadding="3" width="100%">
	<tbody><tr valign="top">
		<td class="SmallText">
	
	<a id="ctl00_ArticleTopHeader_ChapterLink" href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</a> »
	<a id="ctl00_ArticleTopHeader_SectionLink" href="http://www.codeproject.com/KB/GDI-plus/">GDI+</a> »
	<a id="ctl00_ArticleTopHeader_SubsectionLink" href="http://www.codeproject.com/KB/GDI-plus/index.aspx?#GDI+%20-%20General">General</a>
	
	<span id="ctl00_ArticleTopHeader_SkillLevel" class="ArticleBeginner">&nbsp;&nbsp;&nbsp; Beginner</span> 
	<span id="ctl00_ArticleTopHeader_LicenceTerms"></span>
	<br>
	<br>
	<h1><span id="ctl00_ArticleTopHeader_ArticleTitle" class="ArticleTopTitle">ColorMatrix Basics - Simple Image Color Adjustment</span></h1>
	
		<b>By <a href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=153702">Michael Combs</a></b><br>
	
	<br>
    <span id="ctl00_ArticleTopHeader_ArticleDescr">A beginners guide to using the GDI+ ColorMatrix.</span>
</td>
		<td style="width: 210px;">
	<span id="ctl00_ArticleTopHeader_ArticleAttributes" class="SmallText">VB, Windows, .NET, Visual Studio, Dev</span>
	<table style="margin: 8px 0pt 0pt; padding: 0pt;" class="SmallText">
	
	<tbody><tr><td>Posted:</td><td><b>11 Mar 2003</b></td></tr>
	
	<tr><td>Updated:</td><td><b>2 Apr 2003</b></td></tr>
	
	<tr><td>Views:</td><td><b>202,739</b></td></tr>
	
	<tr><td>Bookmarked:</td><td><b>63 times</b></td></tr>
	
	
	
	
	</tbody></table>
</td>
	</tr>
</tbody></table>

	</div>
</div>

<div>

<div id="ctl00_LHNavBar" class="LHNavBar">

	

<div class="announce-header">Announcements</div>
<div class="announce-content">
<table cellpadding="2">














<tbody><tr valign="middle"><td><img src="colormatrix.aspx_files/app_24.jpg" alt="Comp" align="middle" height="24px" width="24px"></td>
<td><a href="http://www.codeproject.com/Competitions/370/Windows-7-Contest.aspx">Windows 7 Comp<br>Win a laptop!</a></td></tr>




<tr valign="middle"><td><img src="colormatrix.aspx_files/MonthlyComp.png" alt="Comp" align="middle" height="24px" width="24px"></td>
<td><a id="ctl00_Announcements_CompLink" href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly Competition</a></td></tr>
</tbody></table>
</div>
		
	
<div id="Th">

<div class="announce-header" style="margin-top: 7px;">Need a job?</div>
<div class="announce-content">


		
		<div style="padding: 7px; background-color: rgb(255, 255, 204);">
		<a id="RelatedJobs_RC_ctl00_Lnk" href="http://www.codeproject.com/Jobs/751/ATG-Developer-Positions.aspx">ATG Developer Positions</a>
		 at AT&amp;T
		 in United States
		</div>
		
	

<br>Know someone who would suit? Or 
	<a id="RelatedJobs_LJ" href="http://www.codeproject.com/script/Jobs/List.aspx">view other jobs...</a>
</div>
</div>

	
	
	<div id="SectionMenu">
<div class="MenuCat">Articles</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1" onclick="return ToggleMenu('Chapter1');">Desktop Development</a></div>
<div class="MenuSectionBlock" id="Chapter1" style="display: none;">
<div class="MI" id="Section1"><a href="http://www.codeproject.com/KB/buttons/">Button Controls</a></div>
<div class="MI" id="Section15"><a href="http://www.codeproject.com/KB/clipboard/">Clipboard</a></div>
<div class="MI" id="Section2"><a href="http://www.codeproject.com/KB/combobox/">Combo &amp; List Boxes</a></div>
<div class="MI" id="Section67"><a href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</a></div>
<div class="MI" id="Section107"><a href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</a></div>
<div class="MI" id="Section16"><a href="http://www.codeproject.com/KB/docview/">Document / View</a></div>
<div class="MI" id="Section4"><a href="http://www.codeproject.com/KB/edit/">Edit Controls</a></div>
<div class="MI" id="Section17"><a href="http://www.codeproject.com/KB/files/">Files and Folders</a></div>
<div class="MI" id="Section3"><a href="http://www.codeproject.com/KB/grid/">Grid &amp; Data Controls</a></div>
<div class="MI" id="Section5"><a href="http://www.codeproject.com/KB/list/">List Controls</a></div>
<div class="MI" id="Section6"><a href="http://www.codeproject.com/KB/menus/">Menus</a></div>
<div class="MI" id="Section14"><a href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</a></div>
<div class="MI" id="Section18"><a href="http://www.codeproject.com/KB/printing/">Printing</a></div>
<div class="MI" id="Section95"><a href="http://www.codeproject.com/KB/progress/">Progress Controls</a></div>
<div class="MI" id="Section11"><a href="http://www.codeproject.com/KB/selection/">Selection Controls</a></div>
<div class="MI" id="Section19"><a href="http://www.codeproject.com/KB/shell/">Shell and IE programming</a></div>
<div class="MI" id="Section68"><a href="http://www.codeproject.com/KB/smart/">Smart Client</a></div>
<div class="MI" id="Section8"><a href="http://www.codeproject.com/KB/splitter/">Splitter Windows</a></div>
<div class="MI" id="Section9"><a href="http://www.codeproject.com/KB/static/">Static &amp; Panel Controls</a></div>
<div class="MI" id="Section10"><a href="http://www.codeproject.com/KB/statusbar/">Status Bar</a></div>
<div class="MI" id="Section7"><a href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property Pages</a></div>
<div class="MI" id="Section12"><a href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking windows</a></div>
<div class="MI" id="Section13"><a href="http://www.codeproject.com/KB/tree/">Tree Controls</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2" onclick="return ToggleMenu('Chapter2');">Web Development</a></div>
<div class="MenuSectionBlock" id="Chapter2" style="display: none;">
<div class="MI" id="Section70"><a href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</a></div>
<div class="MI" id="Section27"><a href="http://www.codeproject.com/KB/applications/">Applications &amp; Tools</a></div>
<div class="MI" id="Section85"><a href="http://www.codeproject.com/KB/asp/">ASP</a></div>
<div class="MI" id="Section89"><a href="http://www.codeproject.com/KB/aspnet/">ASP.NET</a></div>
<div class="MI" id="Section28"><a href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</a></div>
<div class="MI" id="Section38"><a href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</a></div>
<div class="MI" id="Section29"><a href="http://www.codeproject.com/KB/web-cache/">Caching</a></div>
<div class="MI" id="Section91"><a href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and Images</a></div>
<div class="MI" id="Section25"><a href="http://www.codeproject.com/KB/scripting/">Client side scripting</a></div>
<div class="MI" id="Section30"><a href="http://www.codeproject.com/KB/custom-controls/">Custom Controls</a></div>
<div class="MI" id="Section23"><a href="http://www.codeproject.com/KB/HTML/">HTML / CSS</a></div>
<div class="MI" id="Section24"><a href="http://www.codeproject.com/KB/ISAPI/">ISAPI</a></div>
<div class="MI" id="Section33"><a href="http://www.codeproject.com/KB/server-management/">Site &amp; Server Management</a></div>
<div class="MI" id="Section34"><a href="http://www.codeproject.com/KB/session/">Session State</a></div>
<div class="MI" id="Section113"><a href="http://www.codeproject.com/KB/silverlight/">Silverlight</a></div>
<div class="MI" id="Section36"><a href="http://www.codeproject.com/KB/trace/">Trace and Logs</a></div>
<div class="MI" id="Section31"><a href="http://www.codeproject.com/KB/user-controls/">User Controls</a></div>
<div class="MI" id="Section37"><a href="http://www.codeproject.com/KB/validation/">Validation</a></div>
<div class="MI" id="Section35"><a href="http://www.codeproject.com/KB/viewstate/">View State</a></div>
<div class="MI" id="Section26"><a href="http://www.codeproject.com/KB/WAP/">WAP / WML</a></div>
<div class="MI" id="Section32"><a href="http://www.codeproject.com/KB/web-security/">Web Security</a></div>
<div class="MI" id="Section20"><a href="http://www.codeproject.com/KB/webservices/">Web Services</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9" onclick="return ToggleMenu('Chapter9');">Enterprise Systems</a></div>
<div class="MenuSectionBlock" id="Chapter9" style="display: none;">
<div class="MI" id="Section98"><a href="http://www.codeproject.com/KB/MCMS/">Content Management Server</a></div>
<div class="MI" id="Section99"><a href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk Server</a></div>
<div class="MI" id="Section102"><a href="http://www.codeproject.com/KB/exchange/">Microsoft Exchange</a></div>
<div class="MI" id="Section90"><a href="http://www.codeproject.com/KB/office/">Office Development</a></div>
<div class="MI" id="Section101"><a href="http://www.codeproject.com/KB/sharepoint/">SharePoint Server</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3" onclick="return ToggleMenu('Chapter3');">Multimedia</a></div>
<div class="MenuSectionBlock" id="Chapter3">
<div class="MI" id="Section42"><a href="http://www.codeproject.com/KB/audio-video/">Audio and Video</a></div>
<div class="MI" id="Section44"><a href="http://www.codeproject.com/KB/directx/">DirectX</a></div>
<div class="MI" id="Section46"><a href="http://www.codeproject.com/KB/GDI/">GDI</a></div>
<div class="MIS" id="Section47"><a href="http://www.codeproject.com/KB/GDI-plus/">GDI+</a></div>
<div class="MI" id="Section43"><a href="http://www.codeproject.com/KB/graphics/">General Graphics</a></div>
<div class="MI" id="Section45"><a href="http://www.codeproject.com/KB/openGL/">OpenGL</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4" onclick="return ToggleMenu('Chapter4');">Database</a></div>
<div class="MenuSectionBlock" id="Chapter4" style="display: none;">
<div class="MI" id="Section66"><a href="http://www.codeproject.com/KB/database/">Database</a></div>
<div class="MI" id="Section100"><a href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting Services</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8" onclick="return ToggleMenu('Chapter8');">Platforms, Frameworks &amp; Libraries</a></div>
<div class="MenuSectionBlock" id="Chapter8" style="display: none;">
<div class="MI" id="Section83"><a href="http://www.codeproject.com/KB/atl/">ATL</a></div>
<div class="MI" id="Section117"><a href="http://www.codeproject.com/KB/MFC/">MFC</a></div>
<div class="MI" id="Section88"><a href="http://www.codeproject.com/KB/stl/">STL</a></div>
<div class="MI" id="Section84"><a href="http://www.codeproject.com/KB/wtl/">WTL</a></div>
<div class="MI" id="Section49"><a href="http://www.codeproject.com/KB/COM/">COM / COM+</a></div>
<div class="MI" id="Section76"><a href="http://www.codeproject.com/KB/dotnet/">.NET Framework</a></div>
<div class="MI" id="Section92"><a href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; OS</a></div>
<div class="MI" id="Section108"><a href="http://www.codeproject.com/KB/vista/">Vista API</a></div>
<div class="MI" id="Section110"><a href="http://www.codeproject.com/KB/vista-security/">Vista Security</a></div>
<div class="MI" id="Section82"><a href="http://www.codeproject.com/KB/cross-platform/">Cross Platform</a></div>
<div class="MI" id="Section69"><a href="http://www.codeproject.com/KB/game/">Game Development</a></div>
<div class="MI" id="Section73"><a href="http://www.codeproject.com/KB/mobile/">Mobile Development</a></div>
<div class="MI" id="Section106"><a href="http://www.codeproject.com/KB/WC/">Windows CardSpace</a></div>
<div class="MI" id="Section103"><a href="http://www.codeproject.com/KB/WCF/">Windows Communication Foundation</a></div>
<div class="MI" id="Section104"><a href="http://www.codeproject.com/KB/WPF/">Windows Presentation Foundation</a></div>
<div class="MI" id="Section105"><a href="http://www.codeproject.com/KB/WF/">Windows Workflow Foundation</a></div>
<div class="MI" id="Section119"><a href="http://www.codeproject.com/KB/library/">Libraries</a></div>
<div class="MI" id="Section122"><a href="http://www.codeproject.com/KB/powershell/">Windows Powershell</a></div>
<div class="MI" id="Section123"><a href="http://www.codeproject.com/KB/linq/">LINQ</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5" onclick="return ToggleMenu('Chapter5');">Languages</a></div>
<div class="MenuSectionBlock" id="Chapter5" style="display: none;">
<div class="MI" id="Section71"><a href="http://www.codeproject.com/KB/cpp/">C / C++ Language</a></div>
<div class="MI" id="Section72"><a href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</a></div>
<div class="MI" id="Section93"><a href="http://www.codeproject.com/KB/cs/">C#</a></div>
<div class="MI" id="Section78"><a href="http://www.codeproject.com/KB/msil/">MSIL</a></div>
<div class="MI" id="Section86"><a href="http://www.codeproject.com/KB/vbscript/">VBScript</a></div>
<div class="MI" id="Section87"><a href="http://www.codeproject.com/KB/vb/">VB.NET</a></div>
<div class="MI" id="Section115"><a href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</a></div>
<div class="MI" id="Section77"><a href="http://www.codeproject.com/KB/net-languages/">Other .NET Languages</a></div>
<div class="MI" id="Section21"><a href="http://www.codeproject.com/KB/XML/">XML</a></div>
<div class="MI" id="Section96"><a href="http://www.codeproject.com/KB/java/">Java</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6" onclick="return ToggleMenu('Chapter6');">General Programming</a></div>
<div class="MenuSectionBlock" id="Chapter6" style="display: none;">
<div class="MI" id="Section57"><a href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; Recipes</a></div>
<div class="MI" id="Section64"><a href="http://www.codeproject.com/KB/bugs/">Bugs &amp; Workarounds</a></div>
<div class="MI" id="Section79"><a href="http://www.codeproject.com/KB/collections/">Collections</a></div>
<div class="MI" id="Section56"><a href="http://www.codeproject.com/KB/security/">Cryptography &amp; Security</a></div>
<div class="MI" id="Section50"><a href="http://www.codeproject.com/KB/datetime/">Date and Time</a></div>
<div class="MI" id="Section52"><a href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</a></div>
<div class="MI" id="Section80"><a href="http://www.codeproject.com/KB/exception/">Exception Handling</a></div>
<div class="MI" id="Section81"><a href="http://www.codeproject.com/KB/locale/">Localisation</a></div>
<div class="MI" id="Section53"><a href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</a></div>
<div class="MI" id="Section54"><a href="http://www.codeproject.com/KB/tips/">Programming Tips</a></div>
<div class="MI" id="Section55"><a href="http://www.codeproject.com/KB/string/">String handling</a></div>
<div class="MI" id="Section22"><a href="http://www.codeproject.com/KB/IP/">Internet / Network</a></div>
<div class="MI" id="Section58"><a href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; IPC</a></div>
<div class="MI" id="Section59"><a href="http://www.codeproject.com/KB/winhelp/">WinHelp / HTMLHelp</a></div>
<div class="MI" id="Section141"><a href="http://www.codeproject.com/KB/answers/">Uncategorised Quick Answers</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10" onclick="return ToggleMenu('Chapter10');">Graphics / Design</a></div>
<div class="MenuSectionBlock" id="Chapter10" style="display: none;">
<div class="MI" id="Section40"><a href="http://www.codeproject.com/KB/expression/">Expression</a></div>
<div class="MI" id="Section114"><a href="http://www.codeproject.com/KB/usability/">Usability</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11" onclick="return ToggleMenu('Chapter11');">Development Lifecycle</a></div>
<div class="MenuSectionBlock" id="Chapter11" style="display: none;">
<div class="MI" id="Section51"><a href="http://www.codeproject.com/KB/debug/">Debug Tips</a></div>
<div class="MI" id="Section39"><a href="http://www.codeproject.com/KB/architecture/">Design and Architecture</a></div>
<div class="MI" id="Section112"><a href="http://www.codeproject.com/KB/install/">Installation</a></div>
<div class="MI" id="Section41"><a href="http://www.codeproject.com/KB/work/">Work Issues</a></div>
<div class="MI" id="Section128"><a href="http://www.codeproject.com/KB/testing/">Testing and QA</a></div>
<div class="MI" id="Section126"><a href="http://www.codeproject.com/KB/codegen/">Code Generation</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7" onclick="return ToggleMenu('Chapter7');">General Reading</a></div>
<div class="MenuSectionBlock" id="Chapter7" style="display: none;">
<div class="MI" id="Section60"><a href="http://www.codeproject.com/KB/books/">Book Chapters</a></div>
<div class="MI" id="Section61"><a href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</a></div>
<div class="MI" id="Section109"><a href="http://www.codeproject.com/KB/hardware-review/">Hardware Reviews</a></div>
<div class="MI" id="Section63"><a href="http://www.codeproject.com/KB/interviews/">Interviews</a></div>
<div class="MI" id="Section62"><a href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</a></div>
<div class="MI" id="Section48"><a href="http://www.codeproject.com/KB/system/">Hardware &amp; System</a></div>
<div class="MI" id="Section136"><a href="http://www.codeproject.com/KB/Blogs/">Uncategorised Technical Blogs</a></div>
<div class="MI" id="Section140"><a href="http://www.codeproject.com/KB/mentor/">Author Resources</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12" onclick="return ToggleMenu('Chapter12');">Third Party Products</a></div>
<div class="MenuSectionBlock" id="Chapter12" style="display: none;">
<div class="MI" id="Section65"><a href="http://www.codeproject.com/KB/showcase/">Product Showcase</a></div>
<div class="MI" id="Section124"><a href="http://www.codeproject.com/KB/solution-center/">Solution Center</a></div>
</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=13" onclick="return ToggleMenu('Chapter13');">Mentor Resources</a></div>
<div class="MenuSectionBlock" id="Chapter13" style="display: none;">
</div>
</div>
<div style="margin-top: 5px;"></div>
<div class="MenuCat">Services</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Catalog/List.aspx">Product Catalog</a></div>
<div class="MenuChapter"><a href="http://www.codeproject.com/services/certificates/index.aspx">Code-signing Certificates</a></div>
<div class="MenuChapter"><a href="http://www.codeproject.com/script/Jobs/List.aspx">Job Board</a></div>
<div class="MenuChapter"><a href="http://www.codeproject.com/Services/Addins/">CodeProject VS2008 Addin</a></div>
<div style="margin-top: 5px;"></div>
<div class="MenuCat">Feature Zones</div>
<div class="MenuChapter"><a href="http://www.codeproject.com/kb/Showcase/">Product Showcase</a></div>
<div class="MenuChapter"><a href="http://www.codeproject.com/redir.aspx?adid=11864">Code Signing Resources</a></div>
<div class="MenuChapter"><a href="http://www.codeproject.com/Zones/WhitePapers/">WhitePapers / Webcasts</a></div>
<div class="MenuChapter"><a href="http://www.codeproject.com/redir.aspx?adid=8763">ASP.NET Web Hosting</a></div>
<div style="margin-top: 5px;"></div>


	<div style="margin: auto; width: 150px;"><script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d10335%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22%2fscript%2fAdServe%2fServeImg.aspx%3fFile%3dCP_Insider_150x80_B.gif%26C%3dFalse%26adid%3d10335%26obid%3d3772%26obtid%3d2%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150px%22%20height%3d%2280px%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?adid=10335&amp;way=ban" target="_blank" rel="nofollow"><img src="colormatrix.aspx_files/ServeImg_003.htm" alt="" border="0" height="80px" width="150px"></a>
	</div>
	
	<div style="margin: 10px auto auto; width: 160px;"><script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d12505%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22%2fscript%2fAdServe%2fServeImg.aspx%3fFile%3dcodeproject_xn_Dec1_tower_01122009094750.gif%26C%3dFalse%26adid%3d12505%26obid%3d3772%26obtid%3d2%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160px%22%20height%3d%22600px%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?adid=12505&amp;way=ban" target="_blank" rel="nofollow"><img src="colormatrix.aspx_files/ServeImg.htm" alt="" border="0" height="600px" width="160px"></a>
	</div>
</div>

<div id="ctl00_ArticlePane" class="ArticlePane LeftColumn">

	
<table class="SearchHeaderBar" cellspacing="0" width="100%">
<tbody><tr>
<td width="100%">&nbsp;</td>
<td style="white-space: nowrap; width: 60%;" align="right" valign="middle">
	<form method="get" action="/info/search.aspx" name="Search" style="margin: 0pt;">
	<b>Search &nbsp;</b>
	<input class="SmallText" name="artkw" style="width: 200px;">
	<select class="SmallText offblack" style="font-weight: bold;" name="sbo">
	<option value="kw" selected="selected">Articles / Quick Answers</option>
<option value="fm">Messages</option>
<option value="s">Jobs</option>
<option value="ctlk">Product Catalog</option>

	</select>
	<input class="SmallText" style="font-weight: bold;" value=" Go! " type="submit"> &nbsp;
	</form>
</td>
<td class="TinyText" style="white-space: nowrap;">
	
	<a href="http://www.codeproject.com/info/search.aspx">Advanced Search</a><br>
	
	
	<a id="ctl00_SearchBarCtrl_AddToIESearchLnk" href="http://www.codeproject.com/">Add to IE Search</a>
</td>
</tr>
</tbody></table>

	<a name="Main"></a>
	<span id="ctl00_ResultMessage"></span>
	
	
    
	<div id="ctl00_ArtDiv">
	<table border="0" cellpadding="0" cellspacing="0">	
	<tbody><tr valign="top">
		<td valign="top" width="100%">
		    
<table>

</table>



			
<div class="SmallText">
<img src="colormatrix.aspx_files/print.gif" alt="print" style="vertical-align: middle;" height="16px" width="16px"><a id="ctl00_ArticleHeaderLinks_PrintLnk" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?display=Print">Print</a> &nbsp;
	


<span id="SBI"><img src="colormatrix.aspx_files/add.gif" id="ctl00_ArticleHeaderLinks_AddTo_Img" alt="add" style="vertical-align: middle;" height="16" width="16">
<a href="#">Share</a></span>
<div style="left: 196.2px; top: 302.283px;" id="ATD"><div><a class="AddTo" title="Add this page to Digg" onclick="return socialLinks.addto(0);" href="#"><img src="colormatrix.aspx_files/AddTo_Digg.png" align="absmiddle" border="0" height="16px" width="16px"> Digg</a> </div><div><a class="AddTo" title="Add this page to Del.icio.us" onclick="return socialLinks.addto(1);" href="#"><img src="colormatrix.aspx_files/AddTo_Delicious.png" align="absmiddle" border="0" height="16px" width="16px"> Del.icio.us</a> </div><div><a class="AddTo" title="Add this page to Google" onclick="return socialLinks.addto(2);" href="#"><img src="colormatrix.aspx_files/AddTo_Google.png" align="absmiddle" border="0" height="16px" width="16px"> Google</a> </div><div><a class="AddTo" title="Add this page to Windows Live" onclick="return socialLinks.addto(3);" href="#"><img src="colormatrix.aspx_files/AddTo_Live.png" align="absmiddle" border="0" height="16px" width="16px"> Windows Live</a> </div><div><a class="AddTo" title="Add this page to Technorati" onclick="return socialLinks.addto(4);" href="#"><img src="colormatrix.aspx_files/AddTo_Technorati.png" align="absmiddle" border="0" height="16px" width="16px"> Technorati</a> </div><div><a class="AddTo" title="Add this page to Blink" onclick="return socialLinks.addto(5);" href="#"><img src="colormatrix.aspx_files/AddTo_Blink.png" align="absmiddle" border="0" height="16px" width="16px"> Blink</a> </div><div><a class="AddTo" title="Add this page to Facebook" onclick="return socialLinks.addto(6);" href="#"><img src="colormatrix.aspx_files/AddTo_Facebook.png" align="absmiddle" border="0" height="16px" width="16px"> Facebook</a> </div><div><a class="AddTo" title="Add this page to Furl" onclick="return socialLinks.addto(7);" href="#"><img src="colormatrix.aspx_files/AddTo_Furl.png" align="absmiddle" border="0" height="16px" width="16px"> Furl</a> </div><div><a class="AddTo" title="Add this page to Simpy" onclick="return socialLinks.addto(8);" href="#"><img src="colormatrix.aspx_files/AddTo_Simpy.png" align="absmiddle" border="0" height="16px" width="16px"> Simpy</a> </div><div><a class="AddTo" title="Add this page to Reddit" onclick="return socialLinks.addto(9);" href="#"><img src="colormatrix.aspx_files/AddTo_Reddit.png" align="absmiddle" border="0" height="16px" width="16px"> Reddit</a> </div><div><a class="AddTo" title="Add this page to Newsvine" onclick="return socialLinks.addto(10);" href="#"><img src="colormatrix.aspx_files/AddTo_Newsvine.png" align="absmiddle" border="0" height="16px" width="16px"> Newsvine</a> </div><div><a class="AddTo" title="Add this page to Stumbleupon" onclick="return socialLinks.addto(11);" href="#"><img src="colormatrix.aspx_files/AddTo_stumbleupon.png" align="absmiddle" border="0" height="16px" width="16px"> Stumbleupon</a> </div><div><a class="AddTo" title="Add this page to Mr. Wong" onclick="return socialLinks.addto(12);" href="#"><img src="colormatrix.aspx_files/AddTo_MrWong.png" align="absmiddle" border="0" height="16px" width="16px"> Mr. Wong</a> </div><div><a class="AddTo" title="Send as Email" onclick="return socialLinks.addto(13);" href="#"><img src="colormatrix.aspx_files/envelope.gif" align="absmiddle" border="0" height="16px" width="16px"> Send as Email</a> </div></div>
 &nbsp;
 &nbsp;
 &nbsp;
<img src="colormatrix.aspx_files/discuss.gif" alt="Discuss" style="vertical-align: middle;" height="16px" width="15px"> <a href="#_comments">Discuss</a> &nbsp; 

<img src="colormatrix.aspx_files/report.gif" alt="Broken Article?" style="vertical-align: middle;" height="16px" width="16px"><a id="ctl00_ArticleHeaderLinks_BrokenLnk" href="http://www.codeproject.com/script/Articles/Report.aspx?aid=3772">Report</a> &nbsp;
</div>
		</td>
		<td style="text-align: right; white-space: nowrap; width: 100px;">
		<table id="ctl00_CurRat" name="CurRat_3772">
	<tbody><tr>
		<td>
<table>
<tbody><tr>
	<td id="ctl00_ArticleRating_VL" style="white-space: nowrap;" class="SmallText" align="right"> 
		<span id="ctl00_ArticleRating_VoteLabel">42 votes for this article.</span>
	</td>
		
	<td>
		<table border="1" cellpadding="0" cellspacing="0">
			<tbody><tr>
				<td align="left" bgcolor="White" height="7px" width="20px"><img src="colormatrix.aspx_files/red.gif" align="middle" border="0" height="7" width="20"></td>
				<td align="left" bgcolor="White" height="7px" width="20px"><img src="colormatrix.aspx_files/red.gif" align="middle" border="0" height="7" width="20"></td>
				<td align="left" bgcolor="White" height="7px" width="20px"><img src="colormatrix.aspx_files/red.gif" align="middle" border="0" height="7" width="20"></td>
				<td align="left" bgcolor="White" height="7px" width="20px"><img src="colormatrix.aspx_files/red.gif" align="middle" border="0" height="7" width="20"></td>
				<td style="padding: 0px; white-space: nowrap;" align="left" bgcolor="White" height="7px" width="20px"><img src="colormatrix.aspx_files/red.gif" align="middle" border="0" height="7" width="9"><img src="colormatrix.aspx_files/white.gif" align="middle" border="0" height="7" width="11"></td>
			</tr>
		</tbody></table>
		
		<span id="ctl00_ArticleRating_Votes" class="SmallText"></span>
	</td>
</tr>
<tr id="ctl00_ArticleRating_PopularityRow">
			<td colspan="2" class="SmallText" align="right">
		<a id="ctl00_ArticleRating_PopularityLnk" title="Calculated as rating x Log10(# votes)" href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 7.25</a>
		<span id="ctl00_ArticleRating_PopularityLbl"></span>
		<span id="ratingVal">Rating: <b>4.46</b> out of 5</span>
		
	</td>
		</tr>
		
</tbody></table>
</td>
		<td>            
<div>
<table class="HistTable" title="Voting Distribution. Recent data only"><tbody><tr><td><img src="colormatrix.aspx_files/pollcol.gif" alt="1 vote, 2.4%" title="1 vote, 2.4%" border="0px" height="1px" width="10px"><br>1</td>
<td><img src="colormatrix.aspx_files/pollcol.gif" alt="1 vote, 2.4%" title="1 vote, 2.4%" border="0px" height="1px" width="10px"><br>2</td>
<td><img src="colormatrix.aspx_files/pollcol.gif" alt="1 vote, 2.4%" title="1 vote, 2.4%" border="0px" height="1px" width="10px"><br>3</td>
<td><img src="colormatrix.aspx_files/pollcol.gif" alt="10 votes, 23.8%" title="10 votes, 23.8%" border="0px" height="6px" width="10px"><br>4</td>
<td><img src="colormatrix.aspx_files/pollcol.gif" alt="29 votes, 69.0%" title="29 votes, 69.0%" border="0px" height="20px" width="10px"><br>5</td>
</tr></tbody></table>
</div>



</td>
	</tr>
</tbody></table>

		</td>
	</tr>
	</tbody></table>
	
	
	
	

	
	

	
	
	
	
	
	
	
	
	
	
	
	
	<div id="contentdiv">
	
	<!-- Main Page Contents Start -->
	

<!-- Article Starts -->

<p><img alt="Color Image" src="colormatrix.aspx_files/ColorMatrix.jpg" height="300" width="150"> <img alt="Grayscale Image" src="colormatrix.aspx_files/ColorMatrixGray.jpg" height="300" width="150"> <img alt="Blue Image" src="colormatrix.aspx_files/ColorMatrixneg.jpg" height="300" width="150"></p>
<h2>Introduction</h2>
<p>This article discusses color operations on digital images, using the new <code lang="vbnet">ColorMatrix</code> class provided by GDI+. The <code lang="vbnet">ColorMatrix</code>
is a welcome addition to the GDI library, especially with the increase
in demand of digital imaging applications, as more and more consumer
products are made available. This class, as well as many other new GDI
classes, provide more control to the developer and reduce dependence on
3rd party applications such as LEAD tools, and others. Some basic
knowledge of matrix operations (multiplication, addition, etc), the
RGBA colorspace and GDI+ is assumed.</p>
<h2>Background</h2>
<p><code lang="vbnet">ColorMatrix</code> operations are performed in the RGBA colorspace (red, green, blue, alpha). A <code lang="vbnet">ColorMatrix</code>
consists of a 5x5 matrix, with color values normalized to 1 for full
intensity (255 -&gt; 1.0). You might expect the matrix to be 4x4 ( [R,
G, B, A] ), which would be sufficient if we only needed to perform <i>linear</i>
transformations (multiplication: scaling, rotation, etc). However, one
of the most frequent color manipulations, color adjustment, requires
adding color values. This is a <i>non-linear</i> operation, referred to as a translation. Adding a 5<sup>th</sup>
element to the color vector ( [R, G, B, A, w] ) combines these two
operations, linear and non-linear, into a single operation called an <i>affine</i> transformation. The 5<sup>th</sup>
element of the color vector is simply a dummy element, always with a
value of 1, which only serves to allow a translation (addition) of the
color vector.</p>
<p>The example below scales the color vector [255, 128, 102, 255] by .5
and then adds a value of 26 to the R, G and B components, leaving the A
component at full intensity. Remember that the component values are
normalized, with full intensity, 255, equal to 1.0 (values have been
rounded to the nearest tenth). Also notice the addition of the 5th
element to the color vector, which is simply ignored in the resultant
color vector.</p>
<p><img src="colormatrix.aspx_files/ColorMatrixExample.gif" height="83" width="500"> </p>
<p>This takes the color <img src="colormatrix.aspx_files/ColorMatrixColor.jpg" height="28" width="26"> and transforms it to <img src="colormatrix.aspx_files/ColorMatrixColor1.jpg" height="28" width="26">.</p>
<p>Now that we've covered the basic principle of the <code lang="vbnet">ColorMatrix</code> and it's operations on color vectors, we can start exploring some practical uses.</p>
<h2>Applying the code</h2>
<p>Applying a <code lang="vbnet">ColorMatrix</code> to an image is quite simple. You must first associate a <code lang="vbnet">ColorMatrix</code> object with an <code lang="vbnet">ImageAttributes</code> object. Then you simply pass the <code lang="vbnet">ImageAttributes</code> object as a parameter to the <code lang="vbnet">Graphics.DrawImage</code> method.</p>
<p>Color adjustment is one of the more common color operations applied
to digital images. The code to do this might look as follows:</p><div class="SmallText" id="premain0" style="width: 100%; cursor: pointer;"><img preid="0" src="colormatrix.aspx_files/minus.gif" id="preimg0" height="9" width="9"><span preid="0" style="margin-bottom: 0pt;" id="precollapse0"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre0" lang="vbnet"><span class="code-keyword">Public</span> <span class="code-keyword">Function</span> translate(<span class="code-keyword">ByVal</span> img <span class="code-keyword">As</span> Image, <span class="code-keyword">ByVal</span> red <span class="code-keyword">As</span> Single, _
                       <span class="code-keyword">ByVal</span> green <span class="code-keyword">As</span> Single, <span class="code-keyword">ByVal</span> blue <span class="code-keyword">As</span> Single, _
                       <span class="code-keyword">Optional</span> <span class="code-keyword">ByVal</span> alpha <span class="code-keyword">As</span> <span class="code-keyword">Single</span> = <span class="code-digit">0</span>) <span class="code-keyword">As</span> <span class="code-keyword">Boolean</span>

    
    <span class="code-keyword">Dim</span> sr, sg, sb, sa <span class="code-keyword">As</span> <span class="code-keyword">Single</span>
    
    <span class="code-comment">'</span><span class="code-comment"> noramlize the color components to 1
</span>
    sr = red / <span class="code-digit">255</span>
    sg = green / <span class="code-digit">255</span>
    sb = blue / <span class="code-digit">255</span>
    sa = alpha / <span class="code-digit">255</span>
 
    <span class="code-comment">'</span><span class="code-comment"> create the color matrix
</span>
    <span class="code-keyword">dim</span> <span class="code-keyword">New</span> ColorMatrix(<span class="code-keyword">New</span> <span class="code-keyword">Single</span>()() _
                       {<span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {1, 0, 0, 0, <span class="code-digit">0</span>}, _
                        <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 1, 0, 0, <span class="code-digit">0</span>}, _
                        <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 1, 0, <span class="code-digit">0</span>}, _
                        <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 0, 1, <span class="code-digit">0</span>}, _
                        <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {sr, sg, sb, sa, <span class="code-digit">1</span>}})

    <span class="code-comment">'</span><span class="code-comment"> apply the matrix to the image
</span>
    <span class="code-keyword">Return</span> draw_adjusted_image(img, cm)

<span class="code-keyword">End</span> <span class="code-keyword">Function</span>
        
                               
<span class="code-keyword">Private</span> <span class="code-keyword">Function</span> draw_adjusted_image(<span class="code-keyword">ByVal</span> img <span class="code-keyword">As</span> Image, _
                <span class="code-keyword">ByVal</span> cm <span class="code-keyword">As</span> ColorMatrix) <span class="code-keyword">As</span> <span class="code-keyword">Boolean</span>


    <span class="code-keyword">Try</span>
        <span class="code-keyword">Dim</span> bmp <span class="code-keyword">As</span> <span class="code-keyword">New</span> Bitmap(img) <span class="code-comment">'</span><span class="code-comment"> create a copy of the source image 
</span>
        <span class="code-keyword">Dim</span> imgattr <span class="code-keyword">As</span> <span class="code-keyword">New</span> ImageAttributes()
        <span class="code-keyword">Dim</span> rc <span class="code-keyword">As</span> <span class="code-keyword">New</span> Rectangle(0, 0, img.Width, img.Height)
        <span class="code-keyword">Dim</span> g <span class="code-keyword">As</span> Graphics = Graphics.FromImage(img)

        <span class="code-comment">'</span><span class="code-comment"> associate the ColorMatrix object with an ImageAttributes object
</span>
        imgattr.SetColorMatrix(cm) 

        <span class="code-comment">'</span><span class="code-comment"> draw the copy of the source image back over the original image, 
</span>
        <span class="code-comment">'</span><span class="code-comment">applying the ColorMatrix
</span>
        g.DrawImage(bmp, rc, 0, 0, img.Width, img.Height, _
                               GraphicsUnit.Pixel, imgattr)

        g.Dispose()

        <span class="code-keyword">Return</span> <span class="code-keyword">True</span>

    <span class="code-keyword">Catch</span>
        <span class="code-keyword">Return</span> <span class="code-keyword">False</span>
    <span class="code-keyword">End</span> <span class="code-keyword">Try</span>

<span class="code-keyword">End</span> <span class="code-keyword">Function</span></pre>
<p>Conversion to grayscale is another common conversion. Grayscale
values are determined by calculating the luminosity of a color, which
is a weighted average of the R, G and B color components. The average
is weighted according to the sensitivity of the human eye to each color
component. The weights used here are as given by the NTSC (North
America Television Standards Committee) and are widely accepted. </p><div class="SmallText" id="premain1" style="width: 100%; cursor: pointer;"><img preid="1" src="colormatrix.aspx_files/minus.gif" id="preimg1" height="9" width="9"><span preid="1" style="margin-bottom: 0pt;" id="precollapse1"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre1" lang="vbnet"><span class="code-keyword">Public</span> <span class="code-keyword">Function</span> grayscale(<span class="code-keyword">ByVal</span> img <span class="code-keyword">As</span> Image) <span class="code-keyword">As</span> <span class="code-keyword">Boolean</span>


    <span class="code-keyword">Dim</span> cm <span class="code-keyword">As</span> ColorMatrix = <span class="code-keyword">New</span> ColorMatrix(<span class="code-keyword">New</span> <span class="code-keyword">Single</span>()() _
                           {<span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {<span class="code-digit">0</span>.299, <span class="code-digit">0</span>.299, <span class="code-digit">0</span>.299, 0, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {<span class="code-digit">0</span>.587, <span class="code-digit">0</span>.587, <span class="code-digit">0</span>.587, 0, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {<span class="code-digit">0</span>.114, <span class="code-digit">0</span>.114, <span class="code-digit">0</span>.114, 0, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 0, 1, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 0, 0, <span class="code-digit">1</span>}})


    <span class="code-keyword">Return</span> draw_adjusted_image(img, cm)
    
<span class="code-keyword">End</span> <span class="code-keyword">Function</span></pre>
<p>The code below creates a digital negative:</p><div class="SmallText" id="premain2" style="width: 100%; cursor: pointer;"><img preid="2" src="colormatrix.aspx_files/minus.gif" id="preimg2" height="9" width="9"><span preid="2" style="margin-bottom: 0pt;" id="precollapse2"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre2" lang="vbnet"><span class="code-keyword">Public</span> <span class="code-keyword">Function</span> negative(<span class="code-keyword">ByVal</span> img <span class="code-keyword">As</span> Image) <span class="code-keyword">As</span> <span class="code-keyword">Boolean</span>

    <span class="code-keyword">Dim</span> cm <span class="code-keyword">As</span> ColorMatrix = <span class="code-keyword">New</span> ColorMatrix(<span class="code-keyword">New</span> <span class="code-keyword">Single</span>()() _
                           {<span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {-1, 0, 0, 0, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, -1, 0, 0, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, -1, 0, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 0, 1, <span class="code-digit">0</span>}, _
                            <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 0, 0, <span class="code-digit">1</span>}})

    <span class="code-keyword">Return</span> draw_adjusted_image(img, cm)

<span class="code-keyword">End</span> <span class="code-keyword">Function</span></pre>
<p>Color channel separations, alpha transparency adjustment, image
toning (Sepia, etc) are just a few more common operations that can be
easily performed with a <code lang="vbnet">ColorMatrix</code>.</p>






	<!-- Main Page Contents End -->
	
	</div>
	
	
	<form name="aspnetForm" method="post" action="displayarticle.aspx" id="aspnetForm" style="margin: 0pt; padding: 0pt;">
<div>
<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTAyMTMzODg1Ng9kFgJmD2QWBAIKD2QWBAIDDw8WAh4HVmlzaWJsZWdkZAILDw8WAh8AZ2RkAgsPZBYKAgcPZBYMAgEPZBYCZg8WAh4LXyFJdGVtQ291bnRmZAIDD2QWCGYPDxYCHgtOYXZpZ2F0ZVVybAUrL0tCL0dESS1wbHVzL2NvbG9ybWF0cml4LmFzcHg/ZGlzcGxheT1QcmludGRkAgIPDxYCHwBoZGQCAw8PFgIfAGhkZAIEDw8WAh8CBSUvc2NyaXB0L0FydGljbGVzL1JlcG9ydC5hc3B4P2FpZD0zNzcyZGQCBQ8WAh4EbmFtZQULQ3VyUmF0XzM3NzIWAmYPZBYCZg9kFgJmD2QWBAIBD2QWAgIBDw8WAh4EVGV4dAUaNDIgdm90ZXMgZm9yIHRoaXMgYXJ0aWNsZS5kZAIHD2QWAmYPZBYEAgEPDxYEHwQFEFBvcHVsYXJpdHk6IDcuMjUfAgUpL3NjcmlwdC9BcnRpY2xlcy9Ub3BBcnRpY2xlcy5hc3B4P3RhX3NvPTFkZAIFDxYCHwQFHFJhdGluZzogPGI+NC40NjwvYj4gb3V0IG9mIDVkAhkPZBYKAgEPZBYEAgEPFgIeCWlubmVyaHRtbAWxAjxwPlRoaXMgYXJ0aWNsZSBoYXMgbm8gZXhwbGljaXQgbGljZW5zZSBhdHRhY2hlZCB0byBpdCBidXQgbWF5IGNvbnRhaW4gdXNhZ2UgdGVybXMgaW4gdGhlIGFydGljbGUgdGV4dCBvciB0aGUgZG93bmxvYWQgZmlsZXMgdGhlbXNlbHZlcy4gSWYgaW4gZG91YnQgcGxlYXNlIGNvbnRhY3QgdGhlIGF1dGhvciB2aWEgdGhlIGRpc2N1c3Npb24gYm9hcmQgYmVsb3cuPC9wPjxwPkEgbGlzdCBvZiBsaWNlbnNlcyBhdXRob3JzIG1pZ2h0IHVzZSBjYW4gYmUgZm91bmQgPGEgaHJlZj0iL2luZm8vTGljZW5zZXMuYXNweCI+aGVyZTwvYT48L3A+ZAICD2QWAgIBDxBkZBYAZAIFDxYCHwECAWQCBw8WAh8EBfQHPGgyPk90aGVyIHBvcHVsYXIgR0RJKyBhcnRpY2xlczo8L2gyPjx1bD48bGk+PGEgaHJlZj0iL0tCL0dESS1wbHVzL0ltYWdlX1Byb2Nlc3NpbmdfTGFiLmFzcHgiPkltYWdlIFByb2Nlc3NpbmcgTGFiIGluIEMjPC9hPjxkaXYgY2xhc3M9IlNtYWxsVGV4dCI+QSB0b29sIGFuZCBsaWJyYXJ5IGZvciBpbWFnZSBwcm9jZXNzaW5nPC9kaXY+PC9saT48bGk+PGEgaHJlZj0iL0tCL0dESS1wbHVzL2NzaGFycGdyYXBoaWNmaWx0ZXJzMTEuYXNweCI+SW1hZ2UgUHJvY2Vzc2luZyBmb3IgRHVtbWllcyB3aXRoIEMjIGFuZCBHREkrIFBhcnQgMSAtIFBlciBQaXhlbCBGaWx0ZXJzPC9hPjxkaXYgY2xhc3M9IlNtYWxsVGV4dCI+VGhlIGZpcnN0IGluIGEgc2VyaWVzIG9mIGFydGljbGVzIHdoaWNoIHdpbGwgYnVpbGQgYW4gaW1hZ2UgcHJvY2Vzc2luZyBsaWJyYXJ5IGluIEMjIGFuZCBHREkrPC9kaXY+PC9saT48bGk+PGEgaHJlZj0iL0tCL0dESS1wbHVzL0xvdmVseUdvbGRGaXNoRGVza1BldC5hc3B4Ij5BIGxvdmVseSBnb2xkZmlzaCBkZXNrdG9wIHBldCAodXNpbmcgYWxwaGEtUE5HIGFuZCBHREkrKSA8L2E+PGRpdiBjbGFzcz0iU21hbGxUZXh0Ij5Vc2luZyBhbHBoYS1QTkcgYW5kIEdESSsgdGVjaG5vbG9neSB0byBpbXBsZW1lbnQgYSBkZXNrdG9wIHBldCBmaXNoITwvZGl2PjwvbGk+PGxpPjxhIGhyZWY9Ii9LQi9HREktcGx1cy9QbG90M0QuYXNweCI+QSAzRCBQbG90dGluZyBMaWJyYXJ5IGluIEMjPC9hPjxkaXYgY2xhc3M9IlNtYWxsVGV4dCI+QSBsaWJyYXJ5IHdoaWNoIGRyYXdzIDNEIGltYWdlcyBvbiBhbnkgR0RJKyBHcmFwaGljcyBvYmplY3QuPC9kaXY+PC9saT48bGk+PGEgaHJlZj0iL0tCL0dESS1wbHVzL0h0bWxSZW5kZXJlci5hc3B4Ij5BIFByb2Zlc3Npb25hbCBIVE1MIFJlbmRlcmVyIFlvdSBXaWxsIFVzZTwvYT48ZGl2IGNsYXNzPSJTbWFsbFRleHQiPjEwMCUgbWFuYWdlZCBjb2RlIHRoYXQgZHJhd3MgSFRNTCBvbiBhbnkgZGV2aWNlPC9kaXY+PC9saT48L3VsPmQCCQ8PFgIfAGdkZAILD2QWAmYPZBYCAgEPZBYCZg9kFgJmDxYEHwMFDVJhdGVJdGVtXzM3NzIeBWNsYXNzZRYGAgQPFgIfAGgWAgIBDxBkZBYAZAIFDxYCHwBoZAIGDxYCHwBoFgICAQ8PZBYCHgdvbmNsaWNrBSJyZXR1cm4gcmF0ZUl0ZW0oMzc3MiwyLHRydWUsdHJ1ZSk7ZAIbDw8WAh8AZ2RkAiEPFgIfAGhkAgsPDxYCHwIFJi9zY3JpcHQvQXJ0aWNsZXMvQXJ0aWNsZS5hc3B4P2FpZD0zNzcyZGQCEQ8WAh8EBQoyIEFwciAyMDAzZAITDw8WBB8EBQ5TbWl0aGEgVmlqYXlhbh8CBSYvc2NyaXB0L01lbWJlcnNoaXAvVmlldy5hc3B4P21pZD0yODk3MGRkAhUPFgIfBAUfQ29weXJpZ2h0IDIwMDMgYnkgTWljaGFlbCBDb21ic2Rk3HWn6pHgUUu5sjrRghgltSHtZVY=" type="hidden">
</div>


	
	<h2>License</h2>
	<div id="ctl00_LicenseTerms"><p>This
article has no explicit license attached to it but may contain usage
terms in the article text or the download files themselves. If in doubt
please contact the author via the discussion board below.</p><p>A list of licenses authors might use can be found <a href="http://www.codeproject.com/info/Licenses.aspx">here</a></p></div>
	
	<h2>About the Author</h2>
	
			
   
        
<table border="0" cellpadding="0" cellspacing="5" width="100%">
<tbody><tr valign="top">
<td id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable" style="width: 155px;" valign="top">
	<b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" href="http://www.codeproject.com/Members/Michael-Combs">Michael Combs</a></b><br><br>
	<center></center><br>
	<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType" class="SmallText">Member</span>		
</td>

<td> Michael has been developing software for about 12 years primarily
in Fortran, C/C++, Visual Basic and now .NET. His previous experience
includes Internet data services (communication, data storage and
mapping) for the mortgage industry, oil platform instrumentation and
explosives simulation and testing. He holds a B.S. in astrophysics and
computer science. He is currently working for Global Software in
Oklahoma City developing law enforcement and emergency services related
software.<br>	

	<table>
	<tbody><tr id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow">
	<td class="SmallText" nowrap="nowrap">Occupation: </td>
	<td width="100%"><span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle" class="SmallText">Architect</span></td>
</tr>


	

	<tr id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow">
	<td class="SmallText">Location: </td>
	<td width="100%"><span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation" class="SmallText"><img src="colormatrix.aspx_files/US.gif" alt="United States" height="11px" width="16px"> United States</span></td>
</tr>

	</tbody></table>
	</td>
	</tr>
	</tbody></table>


			<br>
		
	
	<table border="0" cellpadding="0" cellspacing="0" width="100%">	
	<tbody><tr valign="top">			
		<td style="width: 100%;">
			<h2>Other popular GDI+ articles:</h2><ul><li><a href="http://www.codeproject.com/KB/GDI-plus/Image_Processing_Lab.aspx">Image Processing Lab in C#</a><div class="SmallText">A tool and library for image processing</div></li><li><a href="http://www.codeproject.com/KB/GDI-plus/csharpgraphicfilters11.aspx">Image Processing for Dummies with C# and GDI+ Part 1 - Per Pixel Filters</a><div class="SmallText">The first in a series of articles which will build an image processing library in C# and GDI+</div></li><li><a href="http://www.codeproject.com/KB/GDI-plus/LovelyGoldFishDeskPet.aspx">A lovely goldfish desktop pet (using alpha-PNG and GDI+) </a><div class="SmallText">Using alpha-PNG and GDI+ technology to implement a desktop pet fish!</div></li><li><a href="http://www.codeproject.com/KB/GDI-plus/Plot3D.aspx">A 3D Plotting Library in C#</a><div class="SmallText">A library which draws 3D images on any GDI+ Graphics object.</div></li><li><a href="http://www.codeproject.com/KB/GDI-plus/HtmlRenderer.aspx">A Professional HTML Renderer You Will Use</a><div class="SmallText">100% managed code that draws HTML on any device</div></li></ul>
		</td>
		<td>
			<script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d12458%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22%2fscript%2fAdServe%2fServeImg.aspx%3fFile%3dCompArt_20093-300x250-alt_20112009044923.png%26C%3dFalse%26adid%3d12458%26obid%3d3772%26obtid%3d2%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22300px%22%20height%3d%22250px%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?adid=12458&amp;way=ban" target="_blank" rel="nofollow"><img src="colormatrix.aspx_files/ServeImg_004.htm" alt="" border="0" height="250px" width="300px"></a>						 
		</td>
	</tr>
	</tbody></table>

	<table id="ctl00_RateArticleRow" class="RatingBar" border="0" cellpadding="0" cellspacing="0" width="100%">
	<tbody><tr>
		<td><a href="#_top">Article Top</a></td>
		<td align="right"><div id="ctl00_RateArticle_RateItemWrapper" style="" name="RateItem_3772" class="">

<table cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
	
	
	<td class="voteTbl" style="white-space: nowrap;" align="right">
		<table class="">
		<tbody><tr valign="middle">
			<td id="ctl00_RateArticle_SignIn" nowrap="nowrap">
				<a href="#SignUp">Sign Up</a> to vote for this article
			</td>
		
			
			
			
			
			
			<td><span id="ctl00_RateArticle_ErrorMessage"></span></td>
		</tr>
		</tbody></table>
	</td>
</tr>
</tbody></table>

<div class="RateComDiv" id="RCD" style="display: none;">
	<table width="100%"><tbody><tr valign="top"><td align="right" width="100%">Your reason for this vote:</td>
	<td><textarea class="RateComment" rows="5" cols="60" style="width: 285px; float: right;"></textarea>
	</td></tr></tbody></table>
</div>

</div>
</td>
	</tr>
</tbody></table>

	</form>
	
	<div style="padding: 10px; overflow: hidden; margin-left: 40px; white-space: nowrap;">		  
		<script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d12208%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22%2fscript%2fAdServe%2fServeImg.aspx%3fFile%3dnsoftware_rc468x60_19102009030054.gif%26C%3dFalse%26adid%3d12208%26obid%3d3772%26obtid%3d2%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22468px%22%20height%3d%2260px%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?adid=12208&amp;way=ban" target="_blank" rel="nofollow"><img src="colormatrix.aspx_files/ServeImg_002.htm" alt="" border="0" height="60px" width="468px"></a>
		
	</div>

	<a name="_comments"></a><!-- Forum Start -->
<div id="_MessageBoard" onclick="return SwitchMessage(event, null)">
	<table id="ForumTable" class="Frm_MainTable" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td class="Frm_MsgAlert"><b>You must <a href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx%3ffid%3d14842%26df%3d90%26mpp%3d25%26noise%3d3%26sort%3dPosition%26view%3dQuick">Sign In</a> to use this message board.</b></td>
		</tr><tr>
			<td><table border="0" cellpadding="3px" cellspacing="0" width="100%">
				<tbody><tr class="Frm_HeaderRow1">
					<td style="white-space: nowrap;"><img src="colormatrix.aspx_files/forum_faq.gif" alt="FAQ" align="middle" border="0" height="16px" width="16px">&nbsp;<a href="http://www.codeproject.com/script/Forums/FAQ.aspx"><b>FAQ</b></a>&nbsp;</td><td style="white-space: nowrap; text-align: right;"><form action="/script/Forums/Search.aspx?fid=0" method="get" style="margin: 0pt; padding: 0pt;">
						<input name="fid" value="14842" type="hidden"><input class="Frm_Input" name="kw" type="text">&nbsp;<input value="Search" name="FrmSrch" class="Frm_Button" type="submit">
					</form></td><td style="text-align: right;"></td>
				</tr><tr class="Frm_HeaderRow2">
					<td colspan="2" style="width: 100%;"><div style="text-align: right;">
						<form action="/script/Forums/SetOptions.aspx?floc=%2fKB%2fGDI-plus%2fcolormatrix.aspx&amp;fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick" method="get" style="margin: 0pt; padding: 0pt;">
							<input name="fid" value="14842" type="hidden"><input name="currentQS" value="?floc=%2fKB%2fGDI-plus%2fcolormatrix.aspx&amp;fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick" type="hidden"><input name="floc" value="/KB/GDI-plus/colormatrix.aspx" type="hidden">Noise Tolerance<select size="1" class="Frm_DropDown" name="noise">
								<option value="1">Very High</option><option value="2">High</option><option selected="selected" value="3">Medium</option><option value="4">Low</option><option value="5">Very Low</option>
							</select>&nbsp;&nbsp;Layout<select size="1" class="Frm_DropDown" name="view">
								<option selected="selected" value="Quick">Normal</option><option value="Topic">Expand Posts only</option><option value="Expanded">Expand Posts &amp; Replies</option><option value="Thread">Thread View</option><option value="Normal">No Javascript</option><option value="Preview">No JS + Preview</option>
							</select>&nbsp;&nbsp;Per page<select size="1" class="Frm_DropDown" name="mpp">
								<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
							</select>&nbsp;&nbsp;&nbsp;<input value="Update" name="SetOpt" class="Frm_Button" type="submit">
						</form>
					</div></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
				<tbody><tr class="Frm_NavigationBar">
					<td>&nbsp;</td><td>Msgs 1 to 25 of 62 (Total in Forum: 62) (<a href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</a>)</td><td style="text-align: right; white-space: nowrap;"><span class="Frm_HL">First</span><span class="Frm_HL">Prev</span><a class="Frm_HL" name="Frm_HoverNL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx">Next</a></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><table class="Frm_MsgTable" border="0" cellpadding="0" cellspacing="0" width="100%">
				<tbody><tr>
					<td><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="5px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3113371_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx3113371xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="3113371" href="http://www.codeproject.com/Messages/3113371/aspx-file-How-to-call-in-a-page-to-see-resluts.aspx">aspx file ? How to call in a page to see resluts ?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=6371566">Alain Van haecke</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">4:00 9 Jul '09 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3113371_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Best of all,<br><br>is there anyone who can share a complete example in an .aspx file so that I can really learn about your scripts ?<br><br>I think to use the ColorMatrix, the code of the .aspx file must contain this kind of code :<br><br>&amp;lt;%@ Page Language="VB" %&amp;gt;<br>&amp;lt;%@ Import Namespace="System.Drawing" %&amp;gt;<br>&amp;lt;%@ Import Namespace="System.Drawing.Text" %&amp;gt;<br>&amp;lt;%@ Import Namespace="System.Drawing.Imaging" %&amp;gt;<br><br>&amp;lt;script language="VB" runat="server"&amp;gt;<br><br>Sub Page_Load(sender As Object, e As EventArgs)<br><br>&nbsp;&nbsp;&nbsp;&nbsp; If Page.IsPostBack Then<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim oBitmap As Bitmap = New Bitmap(468, 60)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim oGraphic As Graphics = Graphics.FromImage(oBitmap)<br><br><br>.......<br><br>MANY
THANKS, I TRIED SINCE MANY DAYS AND DON'T KNOW HOW TO USE, SO THANK YOU
ALL 5I'm not a coder, I'm a pofessional photographer and I would like
to see my picture in grayscale in my webpage, that's all. All the time
I'm trying to learn vbscript I can not work my normal job) Tx, Alain <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3113371" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/3113371/aspx-file-How-to-call-in-a-page-to-see-resluts.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF3113371" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F3061503_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx3061503xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="3061503" href="http://www.codeproject.com/Messages/3061503/Colorize-Image.aspx">Colorize Image</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=2880494">danielku15</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">10:46 31 May '09 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3061503_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I want to create a disabled image in Office 2007 style. It's a kind of sephia image with a blue color key.<br>In photoshop i can archive this by following tasks:<br>1. Use The Colorize Dialog with Hue 214, Saturation 10<br>2. Set the transparency to 50%<br><br>How would the ColorMatrix look like in this case?<br><br>Greets Daniel<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3061503" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/3061503/Colorize-Image.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF3061503" style="white-space: nowrap;">1.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F2968103_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx2968103xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2968103" href="http://www.codeproject.com/Messages/2968103/Sub-OffsetMatrix-incorrect.aspx">Sub OffsetMatrix incorrect</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=5974869">Thomas Nichols</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">7:19 17 Mar '09 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2968103_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">In
Sub OffsetMatrix, the variables roffset, goffset, and boffset are
associated with the 'Alpha' elements. Should be associated with the 'W'
elements as follows:<br><br>Dim mmat as ColorMatrix = _<br>            New ColorMatrix(New Single()() _<br>           {New Single() {1.0, 0.0, 0.0, 0.0, 0.0}, _<br>            New Single() {0.0, 1.0, 0.0, 0.0, 0.0}, _<br>            New Single() {0.0, 0.0, 1.0, 0.0, 0.0}, _<br>            New Single() {0.0, 0.0, 0.0, 1.0, 0.0}, _<br>            New Single() {roffset, goffset, boffset, 0.0, 1.0}})<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2968103" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2968103/Sub-OffsetMatrix-incorrect.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2968103" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F2943492_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx2943492xx"></a><img src="colormatrix.aspx_files/msg_answer.gif" alt="Answer" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2943492" href="http://www.codeproject.com/Messages/2943492/Alpha-Channel-Bug.aspx">Alpha Channel Bug</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1019690">Andy Davies</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">23:09 27 Feb '09 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2943492_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I
just thought I would post to point out a slight error (unsure if it is
in the download, I have only been using the code in the article)<br><br>the colormatrix is created like this:<br><pre><br><span class="code-keyword">Dim</span> cm <span class="code-keyword">As</span> <span class="code-keyword">New</span> ColorMatrix(<span class="code-keyword">New</span> <span class="code-keyword">Single</span>()() { _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {1, 0, 0, 0, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 1, 0, 0, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 1, 0, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 0, 1, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {sr, sg, sb, sa, <span class="code-digit">1</span>} _<br>})<br></pre><br>However after experimenting and a look <a href="http://msdn.microsoft.com/en-us/library/ms533952%28VS.85%29.aspx">here (msdn)</a>[<a href="http://msdn.microsoft.com/en-us/library/ms533952%28VS.85%29.aspx" target="_blank" title="New Window">^</a>]<br><br>I noticed the alpha channel should be here (row 4 and column 4):<br><pre><br><span class="code-keyword">Dim</span> cm <span class="code-keyword">As</span> <span class="code-keyword">New</span> ColorMatrix(<span class="code-keyword">New</span> <span class="code-keyword">Single</span>()() { _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {1, 0, 0, 0, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 1, 0, 0, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 1, 0, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {0, 0, 0, sa, <span class="code-digit">0</span>}, _<br>    <span class="code-keyword">New</span> <span class="code-keyword">Single</span>() {sr, sg, sb, 0, <span class="code-digit">1</span>} _<br>})<br></pre><br>Other than that, excellent article!<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2943492" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2943492/Alpha-Channel-Bug.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2943492" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F2732973_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx2732973xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2732973" href="http://www.codeproject.com/Messages/2732973/Method-for-producing-a-Color-Match-modified.aspx">Method for producing a "Color Match"? [modified]</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=5536266">Michael Schäuble</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">4:29 21 Sep '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2732973_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Hi Michael,<br><br>congratulations for this great article! <br><br>I'm neither a professional programmer nor a picture specialist, but still <img src="colormatrix.aspx_files/smiley_WTF.gif" alt="WTF" align="top">
help in a project for digital restoration of a historical movie. One of
the (many) problems is "flash frames", which are single frames (usually
right before or after a scene cut) that are completely damaged in terms
of colors. Coming from a C-Reality film scanner, the file format btw.
is 10-bit DPX (a bitmap format).<br><br>When I read your article, I was
thinking if the ColorMatrix could open an elegant way to resolve the
problem... e.g. if it was possible to read (or get somehow) the color
profile (ColorMatrix?) from a neighbor frame and apply it to the "flash
frame". From your article I couldn't figure if the ColorMatrix can also
be read from an existing picture. Would you think ColorMatrix's could
be a good way? In case you see a chance (I don't want to be bold <img src="colormatrix.aspx_files/smiley_squeamish.gif" alt="Unsure" align="top"> here) do you probably have an idea HOW to do that with VB 20008 (Express)??? <br><br>Thank you very much,<br>regards from Germany and<br>have a nice day<br><br>Michael <br><br><div class="ForumMod">modified on Sunday, September 21, 2008 9:35 AM</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2732973" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2732973/Method-for-producing-a-Color-Match-modified.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2732973" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F2566580_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx2566580xx"></a><img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2566580" href="http://www.codeproject.com/Messages/2566580/Pure-Black-and-White-modified.aspx">Pure Black and White [modified]</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1338480">Luca Crisi, MCP</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">0:44 23 May '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2566580_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Hi, all. <br><br>Does anyone have a ColorMatrix to make an image use only 2 colors (Black and White)? <br>The effect should be similar to that of a fax print out. <br><br>Possibly, passing in a "quality" (threshold) parameter. <br><br>Let's
say the average ((r + g + b) /3) of the color components is lower or
equal to 128 *, the result will be 0 for all the components. <br><br>Else, it would be 255 (1, in the ColorMatrix "language"). <br><br>* 128 (0.5 is my standard threshold). <br><br>Maybe,
it can be done in two passages, first converting the image to gray and
then applying a "threshold filter", to call it so? <br><br>Bob Powell (<a href="http://www.bobpowell.net/onebit.htm">Converting an RGB image to 1 bit-per-pixel monochrome</a>) succeeded in, but: <br>1. He uses unmanaged APIs. <br>2. He uses InterOps. <br>3. He does the thing one pixel at a time... <br><br>Bob is really an experienced developer, buy this "naive" solution is totally unacceptable for me. <br><br>Is there anyone that can do the same by using a ColorMatrix? <br>Or an ImageAttributes? <br>Or a combination of the two? <br><br><div class="ForumMod">modified on Monday, May 26, 2008 7:22 AM</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2566580" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2566580/Pure-Black-and-White-modified.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2566580" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F2566816_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34px"><a name="xx2566816xx"></a><img src="colormatrix.aspx_files/msg_answer.gif" alt="Answer" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2566816" href="http://www.codeproject.com/Messages/2566816/Re-Pure-Black-and-White-modified.aspx">Re: Pure Black and White [modified]</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1338480">Luca Crisi, MCP</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">3:19 23 May '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2566816_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="34px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Sorry,
but I had to reply myself, since I did find a "not too bad" solution,
and it might be that someone of you finds it useful for their needs. <br><br>Well, I ended up with a two steps solution.<br>I'm still waiting to find a single ColorMatrix that could do that on the fly... <br><br>Also, I noticed that some Images don't pruduce a TRUE B/W, but there's still some color bleeding.<br>This happens with some PNG Images.<br><br>I think it's due to a "dirty" Alpha Channel, but still can't help.<br><br>Maybe,
a solution could be calling the ImageBlackAndWhite Method twice, or to
put a For cicle inside it to repeat the two steps twice.<br><br>' The Methods I use to do the Conversions:<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Friend Sub ImageBlackAndWhite(ByVal img As Image, _<br>&nbsp;&nbsp;&nbsp;&nbsp;  ByVal Threshold As Int32)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' This Method returns the Image in pure Black &amp;amp; White Colors.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Very much like a Fax Print out.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Two Steps are required, and the Order is meaningful.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Adjust the Threshold Value.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; If Threshold &amp;lt; 0 Then Threshold = 0<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; If Threshold &amp;gt; 100 Then Threshold = 100<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' This is a two Step Operation:<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' First Step:<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Convert the Image to GrayScale.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ImageGrayScale(img)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Second Step:<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Set a Threshold to the Image.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ImageThreshold(img, Threshold)<br>&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Friend Sub ImageGrayScale(ByVal img As Image)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' This Method converts an Image to GrayScale.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Create the Color Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; '' SimpleAverage GrayScale Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 'Dim cm As New ColorMatrix(New Single()() { _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.333F, 0.333F, 0.333F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.333F, 0.333F, 0.333F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.333F, 0.333F, 0.333F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; '' WeightAverage GrayScale Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 'Dim cm As New ColorMatrix(New Single()() { _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.333F, 0.333F, 0.333F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.444F, 0.444F, 0.444F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.222F, 0.222F, 0.222F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; '' Bob Powell's GrayScale Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 'Dim cm As ColorMatrix = New ColorMatrix(New Single()() { _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.5, 0.5, 0.5, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.5, 0.5, 0.5, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.5, 0.5, 0.5, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; '' Gilles Khouzam's Colour corrected Shear GrayScale Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 'Dim cm As ColorMatrix = New ColorMatrix(New Single()() { _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.3, 0.3, 0.3, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.59, 0.59, 0.59, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.11, 0.11, 0.11, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; '' Luminance Vector GrayScale Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; '' This is the one Microsoft prefers.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 'Dim cm As New ColorMatrix(New Single()() { _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.3086F, 0.3086F, 0.3086F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.6094F, 0.6094F, 0.6094F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.082F, 0.082F, 0.082F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; '' NtscPal (CCIR Rec. 604 standard) GrayScale Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 'Dim cm As New ColorMatrix(New Single()() { _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.299F, 0.299F, 0.299F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.587F, 0.587F, 0.587F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0.114F, 0.114F, 0.114F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' CCIR Rec. 709 standard GrayScale Matrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' This one is the most used.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim cm As New ColorMatrix(New Single()() { _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  New Single() {0.213F, 0.213F, 0.213F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  New Single() {0.715F, 0.715F, 0.715F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  New Single() {0.072F, 0.072F, 0.072F, 0, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Apply the Matrix to the Image.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; DrawImage(img, cm)<br>&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Friend Sub ImageThreshold(ByVal img As Image, _<br>&nbsp;&nbsp;&nbsp;&nbsp;  ByVal Threshold As Int32)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' This Method sets an Image Threshold.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Adjust Threshold Value.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; If Threshold &amp;lt; 0 Then Threshold = 0<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; If Threshold &amp;gt; 100 Then Threshold = 100<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' 0.01F * x is faster than x / 100<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim tsh As Single = 0.01F * Threshold<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Create an ImageAttributes Object, and set its Bitmap Threshold.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim ia As New ImageAttributes<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ia.SetThreshold(tsh, ColorAdjustType.Bitmap)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Apply the ImageAttributes to the Image.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; DrawImage(img, ia)<br>&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br><br><br>' I also use these Overloads:<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Private Overloads Sub DrawImage(ByVal img As Image, _<br>&nbsp;&nbsp;&nbsp;&nbsp;  ByVal cm As ColorMatrix)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Draw an Image with a specified ColorMatrix Object.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Try<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Create a Copy of the Source Image.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim bmp As New Bitmap(img)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim ia As New ImageAttributes<br>&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim rect As New
Rectangle(0, 0, img.Width, img.Height)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Using gr As Graphics = Graphics.FromImage(img)<br>&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; ' Associate the ColorMatrix Object with an
ImageAttributes<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Object.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ia.SetColorMatrix(cm)<br>&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; ' Draw the Copy of the Source Image back over
the Original<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Image, applying the
ColorMatrix.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; gr.DrawImage(bmp,
rect, 0, 0, img.Width, img.Height, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  GraphicsUnit.Pixel, ia)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; End Using<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Catch<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Eat the Exception.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; End Try<br>&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br>&nbsp;&nbsp;&nbsp;&nbsp; Private Overloads Sub DrawImage(ByVal img As Image, _<br>&nbsp;&nbsp;&nbsp;&nbsp;  ByVal ia As ImageAttributes)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Draw an Image with a specified ImageAttributes Object.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Try<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Create a Copy of the Source Image.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim bmp As New Bitmap(img)<br>&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim rect As New
Rectangle(0, 0, img.Width, img.Height)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Using gr As Graphics = Graphics.FromImage(img)<br>&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; ' Draw the Copy of the Source Image back over
the Original<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Image, applying the
ImageAttributes.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; gr.DrawImage(bmp,
rect, 0, 0, img.Width, img.Height, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  GraphicsUnit.Pixel, ia)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; End Using<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Catch<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ' Eat the Exception.<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; End Try<br>&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br><br><br><br>' Somewhere in the Form I call these Instructions and do the Trick:<br><br>' Load the Image from the original one, which is stored in PictureBox1.<br>PictureBox7.Image = CType(PictureBox1.Image.Clone, Image)<br>' Apply the Transformation with a Thresold of 50%.<br>.ImageBlackAndWhite(PictureBox7.Image, 50) <br><br>&lt;div class="ForumMod"&gt;modified on Tuesday, May 27, 2008 7:04 AM&lt;/div&gt;<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2566580" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2566816/Re-Pure-Black-and-White-modified.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2566816" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F2759070_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="52px"><a name="xx2759070xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2759070" href="http://www.codeproject.com/Messages/2759070/Re-Pure-Black-and-White.aspx">Re: Pure Black and White</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=4587157">Aamir Mustafa</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">18:43 9 Oct '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2759070_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 52px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="52px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">hi<br>can u help me converting this code in vb.net and then how to apply it<br>thanks <br><br><div class="ForumSig">Aamir Mustafa</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2566580" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2759070/Re-Pure-Black-and-White.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2759070" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F2762932_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="70px"><a name="xx2762932xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2762932" href="http://www.codeproject.com/Messages/2762932/Re-Pure-Black-and-White.aspx">Re: Pure Black and White</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1338480">Luca Crisi, MCP</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">9:27 13 Oct '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2762932_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 70px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="70px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">What language do you think it is?<br><br>On
top of my contribution, the methods I used, and near the end, you'll
find a statement like "somewhere in the code ..." - that's how to use
the above code.<br><br>Of course, it's all meant to be used inside the existing project code, just as an addition. <br><br><div class="ForumSig">Luca Crisi, MCP<br></div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2566580" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2762932/Re-Pure-Black-and-White.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2762932" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F2234135_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx2234135xx"></a><img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2234135" href="http://www.codeproject.com/Messages/2234135/Saving-Changed-Image-Format.aspx">Saving Changed Image Format</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1744532">stixoffire</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">1:16 19 Sep '07 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2234135_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I know your article is quite old but it seems most relevant to what I am trying to do.<br>I
have been searching for how to write an image in Lab format instead of
RGB, I have converted the RGB values into a decimal array (decimal for
precision) but now I just dont know what to do with them - how do I
write them back to a file in the format of Lab ? <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2234135" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2234135/Saving-Changed-Image-Format.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2234135" style="white-space: nowrap;">1.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F2179568_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx2179568xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2179568" href="http://www.codeproject.com/Messages/2179568/How-to-Apply.aspx">How to Apply</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=4231795">*shona</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">1:53 13 Aug '07 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2179568_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Hi..<br>   Plz tell me how to apply this code...<br>Thanks<img src="colormatrix.aspx_files/smiley_cry.gif" alt="Cry" align="top"> <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2179568" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2179568/How-to-Apply.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2179568" style="white-space: nowrap;">1.00/5 (2 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F1986392_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1986392xx"></a><img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1986392" href="http://www.codeproject.com/Messages/1986392/How-to-do-softlight-on-an-image.aspx">How to do softlight on an image?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=3333840">freecoke</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">7:41 12 Apr '07 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1986392_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">help，Michael.<br>How to do softlight on an image? <br>What are the Values to pass for the matrix ?<br>Is there some releated algorithms to do on the pixel?<br><br>Any help is appreciated, Thank you! <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1986392" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1986392/How-to-do-softlight-on-an-image.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1986392" style="white-space: nowrap;">2.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F1934934_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1934934xx"></a><img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1934934" href="http://www.codeproject.com/Messages/1934934/Save-File-modified.aspx">Save File [modified]</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=2714266">CarlHackman</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">14:22 11 Mar '07 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1934934_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Hi Michael<br><br>I know it's a bit long since you have done this article but I am having a problem saving the adjusted image.<br><br>I
display the image and a copy. I adjust the copy using a matrix, using a
copy of the source. It shows great on the screen but I am having
problems actually saving the image with the matrix applied. All it does
is save the copy without the matrix values applied.<br><br>This displays the source image<br><br><code><span class="code-keyword">Private</span> <span class="code-keyword">Function</span> draw_source_image(<span class="code-keyword">ByVal</span> g <span class="code-keyword">As</span> Graphics) <span class="code-keyword">As</span> <span class="code-keyword">Boolean</span><br><br>        <span class="code-keyword">Try</span><br>            <span class="code-keyword">Dim</span> bmp <span class="code-keyword">As</span> <span class="code-keyword">New</span> Bitmap(sourceImage, 256, <span class="code-digit">256</span>) <span class="code-comment">'</span><span class="code-comment"> draw the source image <br></span>            <span class="code-keyword">Dim</span> rc <span class="code-keyword">As</span> <span class="code-keyword">New</span> Rectangle(150, 50, sourceImage.Width, sourceImage.Height)<br><br>            g.DrawImage(bmp, rc, 0, 0, sourceImage.Width, sourceImage.Height, _<br>                                   GraphicsUnit.Pixel)<br>            <span class="code-keyword">Return</span> <span class="code-keyword">True</span><br>        <span class="code-keyword">Catch</span><br>            <span class="code-keyword">Return</span> <span class="code-keyword">False</span><br>        <span class="code-keyword">End</span> <span class="code-keyword">Try</span><br><br>    <span class="code-keyword">End</span> <span class="code-keyword">Function</span><br></code><br><br>This displays the adjusted image<br><br><code><span class="code-keyword">Private</span> <span class="code-keyword">Function</span> draw_adjusted_image(<span class="code-keyword">ByVal</span> cm <span class="code-keyword">As</span> ColorMatrix, <span class="code-keyword">ByVal</span> g <span class="code-keyword">As</span> Graphics) <span class="code-keyword">As</span> <span class="code-keyword">Boolean</span><br><br>        <span class="code-keyword">Try</span><br>            adjustedImage = <span class="code-keyword">New</span> Bitmap(sourceImage, 256, <span class="code-digit">256</span>) <span class="code-comment">'</span><span class="code-comment"> create a copy of the source image <br></span>            <span class="code-keyword">Dim</span> imgattr <span class="code-keyword">As</span> <span class="code-keyword">New</span> ImageAttributes()<br>            <span class="code-keyword">Dim</span> rc <span class="code-keyword">As</span> <span class="code-keyword">New</span> Rectangle(450, 50, sourceImage.Width, sourceImage.Height)<br><br>            <span class="code-comment">'</span><span class="code-comment"> associate the ColorMatrix object with an ImageAttributes object<br></span>            imgattr.SetColorMatrix(cm, ColorMatrixFlag.Default, ColorAdjustType.<span class="code-keyword">Default</span>)<br><br>            <span class="code-comment">'</span><span class="code-comment">applying the ColorMatrix<br></span>            g.DrawImage(adjustedImage, rc, 0, 0, sourceImage.Width, sourceImage.Height, _<br>                                  GraphicsUnit.Pixel, imgattr)<br><br>            <span class="code-keyword">Return</span> <span class="code-keyword">True</span><br>        <span class="code-keyword">Catch</span><br>            <span class="code-keyword">Return</span> <span class="code-keyword">False</span><br>        <span class="code-keyword">End</span> <span class="code-keyword">Try</span><br><br>    <span class="code-keyword">End</span> <span class="code-keyword">Function</span><br></code><br><br>This saves the adjusted image to disc.  I'm not too worried about the size yet as I can adjust that before the save.<br><br><code><span class="code-keyword">Private</span> <span class="code-keyword">Sub</span> saveImage()<br>        <span class="code-comment">'</span><span class="code-comment">here we save the image to file<br></span>        <span class="code-keyword">Dim</span> mDiag <span class="code-keyword">As</span> <span class="code-keyword">New</span> SaveFileDialog<br><br>        mDiag.Filter = <span class="code-string">"</span><span class="code-string">Bitmap Image|*.bmp"</span><br>        mDiag.ShowDialog()<br>        adjustedImage.Save(mDiag.FileName, ImageFormat.Bmp)<br><br>    <span class="code-keyword">End</span> <span class="code-keyword">Sub</span><br></code><br><br>I just want to save as a bitmap so that I can later compress it to DXT5 if necessary<br><br>Many thanks <br><br>Regards<br><br>Carl<br><br><br> -- modified at 12:56 Monday 12th March, 2007 <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1934934" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1934934/Save-File-modified.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1934934" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F1934073_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1934073xx"></a><img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1934073" href="http://www.codeproject.com/Messages/1934073/abaout-grayscale.aspx">abaout grayscale</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=3909473">aimaniez</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">14:22 10 Mar '07 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1934073_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">i want to ask source code (in vb6)for transform RGB image to grayscale image.thank for your attention <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1934073" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1934073/abaout-grayscale.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1934073" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F1775784_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1775784xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1775784" href="http://www.codeproject.com/Messages/1775784/Understanding-The-Matrix.aspx">Understanding The Matrix</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1548869">JonFrost</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">0:32 26 Nov '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1775784_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Hey there,<br><br>I did some head-scratching on this one and I've come with this:<br><br>All
values in row 0 are based on the red component of the pixel to which
they are applied. Likewise, all values in rows 1, 2 and 3 are based on
the green, blue and alpha components of the pixel consecutively.<br><br>The
values in column 0 apply to the amount of red that will be placed in a
given pixel. Similarly, columns 1, 2 and 3 are applied to the green,
blue and alpha components.<br><br>So, for example, if I set 00, 11, 22
and 33 to 1.0, I'll get a regular picture, because I'm specifying
regular amounts of each component based on only that component.<br><br>But
if I were to set 01 to 0.5 then I would be adding 0.5 times the green
value of each pixel to the resulting colors red component. And so
forth... <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1775784" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1775784/Understanding-The-Matrix.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1775784" style="white-space: nowrap;">2.00/5 (3 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F1689307_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1689307xx"></a><img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1689307" href="http://www.codeproject.com/Messages/1689307/Coloring-a-grayscale-image.aspx">Coloring a grayscale image</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=855156">kspaun</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">3:17 28 Sep '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1689307_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I
use the following method for coloring an image. My source image is a
black font with a transparent background. I just want to color that
graphical font. This font is not absolutely black it contains
grayscales so ColorMap is not the right option.<br><br>private Bitmap ColorBitmap(Bitmap _b, Color _color)<br>{<br>  Bitmap bmp = new Bitmap(_b.Width, _b.Height);<br>  Graphics g = Graphics.FromImage(bmp);<br><br>  float cr = _color.R / 255;<br>  float cg = _color.G / 255;<br>  float cb = _color.B / 255;<br>  float ca = _color.A / 255;<br>            <br>  float[][] colorMatrixElements = { <br>  new float[] {1, 0, 0, 0, 0},<br>  new float[] {0, 1, 0, 0, 0},<br>  new float[] {0, 0, 1, 0, 0},<br>  new float[] {0, 0, 0, 1, 0},<br>  new float[] {cr, cg, cb, ca, 1}};<br>           <br>  ColorMatrix colorMatrix = new ColorMatrix(colorMatrixElements);<br>            <br>  ImageAttributes imageAttributes = new ImageAttributes();<br>  imageAttributes.SetColorMatrix(colorMatrix, ColorMatrixFlag.Default, ColorAdjustType.Default);<br><br>   Rectangle rectangle = new Rectangle(0, 0, _b.Width, _b.Height);<br><br>   g.DrawImage(_b, rectangle, 0, 0, _b.Width, _b.Height, GraphicsUnit.Pixel, imageAttributes);<br>            <br>   return bmp;<br>}<br><br>I
must admit that I don´t understand the concepts of the ColorMatrix. Is
anybody able to modify my method in a way that I am able to color a
grayscale image into any color ?<br><br><br> <br><br>Best Regards, Kevin<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1689307" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1689307/Coloring-a-grayscale-image.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1689307" style="white-space: nowrap;">1.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote HdUnSel " id="F1876513_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34px"><a name="xx1876513xx"></a><img src="colormatrix.aspx_files/msg_answer.gif" alt="Answer" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1876513" href="http://www.codeproject.com/Messages/1876513/Re-Coloring-a-grayscale-image.aspx">Re: Coloring a grayscale image</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1600711">thefellow3j</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">21:32 3 Feb '07 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1876513_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="34px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Try using a matrix that combines grayscaling with the color component addition. Here goes one:<br><br><code><span class="code-comment">//</span><span class="code-comment"> The grayscale factors used here come from the CCIR Rec. 709 standard.<br></span><span class="code-keyword">float</span>[][] colorMatrixElements = {<br><span class="code-keyword">new</span> <span class="code-keyword">float</span>[] { <span class="code-digit">0</span>.213f, <span class="code-digit">0</span>.213f, <span class="code-digit">0</span>.213f, <span class="code-digit">0</span>, <span class="code-digit">0</span> }, <br><span class="code-keyword">new</span> <span class="code-keyword">float</span>[] { <span class="code-digit">0</span>.715f, <span class="code-digit">0</span>.715f, <span class="code-digit">0</span>.715f, <span class="code-digit">0</span>, <span class="code-digit">0</span> }, <br><span class="code-keyword">new</span> <span class="code-keyword">float</span>[] { <span class="code-digit">0</span>.072f, <span class="code-digit">0</span>.072f, <span class="code-digit">0</span>.072f, <span class="code-digit">0</span>, <span class="code-digit">0</span> }, <br><span class="code-keyword">new</span> <span class="code-keyword">float</span>[] { <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">1</span>, <span class="code-digit">0</span> },<br><span class="code-keyword">new</span> <span class="code-keyword">float</span>[] { cr, cg, cb, ca, <span class="code-digit">1</span> }};</code> <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1689307" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1876513/Re-Coloring-a-grayscale-image.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1876513" style="white-space: nowrap;">1.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F1565993_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1565993xx"></a><img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1565993" href="http://www.codeproject.com/Messages/1565993/how-to-do-sharpness-and-blur-modified.aspx">how to do sharpness and blur [modified]</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=3045456">singam1</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">4:35 7 Jul '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1565993_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Nice article Michael..<br>It helped me a lot..<br>Is it possible to do sharpness and blur operation on the image using the Colormatrix.<br>If so what are all the values we have to pass for the matrix elements..<br><br>Any help is appreciated..<br>Thanks in advance.<br>sing<br><br> -- modified at 9:36 Friday 7th July, 2006<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1565993" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1565993/how-to-do-sharpness-and-blur-modified.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1565993" style="white-space: nowrap;">2.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote HdUnSel " id="F1586509_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34px"><a name="xx1586509xx"></a><img src="colormatrix.aspx_files/msg_answer.gif" alt="Answer" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1586509" href="http://www.codeproject.com/Messages/1586509/Re-how-to-do-sharpness-and-blur-modified.aspx">Re: how to do sharpness and blur [modified]</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=2231903">wlh21cn</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">0:44 20 Jul '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1586509_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="34px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I
think ColorMatrix can't sharp and blur image. ColorMatrix only changes
every pixel, doesn't consider the relation of pixels, while sharp and
blur must consider neighboring pixels.<br><br>It's easy to blur image, create a 3*3 matrix, calculate every pixel by matrix and neighboring pixel, for example,<br>matrix is<br>0.05  0.05  0.05<br>0.05  0.60  0.05<br>0.05  0.05  0.05<br>pixels' gray value are<br>100   110   120<br>130   140   160<br>170   180   190<br>after blur, the center pixel's gray value is not 140, it's<br>(100+110+120+130+160+170+180+190)*0.05+140*0.6=145.<br><br>It's easy to apply this method to RGB color space.<br><br>I don't how to sharp an image.<br><br><br> -- modified at 5:48 Thursday 20th July, 2006<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1565993" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1586509/Re-how-to-do-sharpness-and-blur-modified.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1586509" style="white-space: nowrap;">2.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F1481512_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1481512xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1481512" href="http://www.codeproject.com/Messages/1481512/Strange-bug-while-printing.aspx">Strange bug while printing</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=819016">Pugwash2004</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">1:23 10 May '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1481512_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">There seems to be a bug in the .net2.0 printing support while using imageattributes. <br><br>
I had been trying to print a jpeg image with an alpha adjust in the
colormatrix. In a print preview dialog it works perfectly, however when
it got to the stage of printing I was getting an outofmemory exception.
<br><br> I figured it out eventually after I had tried using a png with
a transparent background. The format of the image has to be 32bppARGB
or changed to it, you can do this by creating a new bitmap with the
32bppARGB format that is the same size as the original and draw the
original in that, the code I used is below.<br><br><code><span class="code-keyword">Dim</span> newImage <span class="code-keyword">As</span> System.Drawing.Image = image.fromfile(<span class="code-string">"</span><span class="code-string">c:\sample.jpg"</span>)<br><span class="code-keyword">Dim</span> bm <span class="code-keyword">As</span> <span class="code-keyword">New</span> Bitmap(newImage.Width, newImage.Height,  imaging.PixelFormat.Format32bppArgb)<br><br><span class="code-keyword">Dim</span> g <span class="code-keyword">As</span> Graphics = Graphics.FromImage(bm)<br>g.DrawImage(newImage, 0, 0, newImage.Width, newImage.Height)<br>g.dispose()<br>newimage.dispose()</code><br><br><code>bm</code> now holds an image that can be printed using a colormatrix.<br>This does not affect a png with a transparent background.<br><br> -- modified at 7:26 Wednesday 10th May, 2006<br><br>ok
I've just found out something even better, the bug only seems to affect
loading an image in the system.drawing.image class. If you use the
system.drawing.bitmap class to load your image, printing works
perfectly even if you do a conversion to the system.drawing.image
class! I can only assume that the bitmap class defaults to the
32bppArgb format, where as the image class defaults to the files colour
format.<br><br>Obviously if your using a third party class then the
first method may still be appropriate as you have no control on how
pictures are loaded.<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1481512" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1481512/Strange-bug-while-printing.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1481512" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F1098365_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1098365xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1098365" href="http://www.codeproject.com/Messages/1098365/Complete-Grayscale-Class.aspx">Complete Grayscale Class</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/usersuss.gif" alt="suss" height="15px" width="14px"></td><td class="Frm_MsgAuthor">Anonymous</td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">11:49 3 May '05 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1098365_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">This class can be used to convert bitmaps (as well as color objects) to grayscale using several semi-standard formulas.<br><br>I
had to remove the Xml documentation since it was interfering with the
message format, but it should be fairly straightforward to figure out.<br><br>&lt;code&gt;<br>Dim oGray As New OpenBook.Graphics.Colors.Grayscale<br>_newImage = oGray.ConvertBitmapToGrayscale(_oldImage, OpenBook.Graphics.Colors.Grayscale.Formula.CCIRRec709)<br>&lt;/code&gt;<br><br>You
will have to replace [OpenBook] with something else.&nbsp;&nbsp; It's
simply the way I've organized the namespaces for myself.<br><br>Thanks
to the original author of this tutorial on the help with
ColorMatrix.&nbsp;&nbsp; It makes an enormous performance difference
(even if I wish it was a bit quicker still).<br><br>Kevin Townsend<br><br>&lt;code&gt;<br>Imports System.Drawing<br>Imports System.Drawing.Imaging<br><br>Namespace Graphics.Colors<br><br>&nbsp;&nbsp; &nbsp;&nbsp; Public Class Grayscale<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Public Enum Formula<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
SimpleAverage = 0&nbsp;&nbsp; &nbsp;&nbsp; ' Least accurate<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; WeightAverage = 1<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
NtscPal = 2&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; ' CCIR Recommendation 601-1 (Used in Ntsc/Pal Standards)<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
CCIRRec709 = 3&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; '
CCIR Recommendation 709<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; End Enum<br><br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Public Function
ConvertRgbToGrayscale(ByVal sourceColor As Drawing.Color, Optional
ByVal formula As Formula = Formula.CCIRRec709)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim newColor As New Drawing.Color<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim a1, r1, g1, b1 As Int16<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim a2, r2, g2, b2 As Int16<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Get source color ARGB attributes<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; a1 = Convert.ToInt16(sourceColor.A)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; r1 = Convert.ToInt16(sourceColor.R)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; g1 = Convert.ToInt16(sourceColor.G)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; b1 = Convert.ToInt16(sourceColor.B)<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Calculate changes depending on foruma selected<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Select Case formula<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; Case formula.SimpleAverage<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; a2 = a1<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; r2 =
Convert.ToInt16((r1 + g1 + b1) / 3)<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; g2 = Convert.ToInt16((r1 + g1 +
b1) / 3)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; b2 = Convert.ToInt16((r1 + g1 + b1) / 3)<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; Case formula.WeightAverage<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; a2 = a1<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; r2 =
Convert.ToInt16((3 * r1) + (4 * b1) + (2 * g1) / 9)<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; g2 =
Convert.ToInt16((3 * r1) + (4 * b1) + (2 * g1) / 9)<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; b2 =
Convert.ToInt16((3 * r1) + (4 * b1) + (2 * g1) / 9)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Case formula.NtscPal<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; a2 = a1<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; r2 =
Convert.ToInt16((0.299 * r1) + (0.587 * g1) + (0.114 * b1))<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; g2 =
Convert.ToInt16((0.299 * r1) + (0.587 * g1) + (0.114 * b1))<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; b2 =
Convert.ToInt16((0.299 * r1) + (0.587 * g1) + (0.114 * b1))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Case formula.CCIRRec709<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; a2 = a1<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; r2 =
Convert.ToInt16((0.2125 * r1) + (0.7154 * g1) + (0.0721 * b1))<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; g2 =
Convert.ToInt16((0.2125 * r1) + (0.7154 * g1) + (0.0721 * b1))<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; b2 =
Convert.ToInt16((0.2125 * r1) + (0.7154 * g1) + (0.0721 * b1))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Case Else<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Use CCIR Rec 709
as default<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; a2 = a1<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; r2 = Convert.ToInt16((0.2125 * r1) + (0.7154
* g1) + (0.0721 * b1))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; g2 = Convert.ToInt16((0.2125 * r1) + (0.7154
* g1) + (0.0721 * b1))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; b2 = Convert.ToInt16((0.2125 * r1) + (0.7154
* g1) + (0.0721 * b1))<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; End Select<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Check limits<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If r2 &gt; 255 Then r2 = 255<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If g2 &gt; 255 Then g2 = 255<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If b2 &gt; 255 Then b2 = 255<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If r2 &lt; 0 Then r2 = 0<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If g2 &lt; 0 Then g2 = 0<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If b2 &lt; 0 Then b2 = 0<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Set newColor<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; newColor = Drawing.Color.FromArgb(a2, r2, g2, b2)<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Return<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Return newColor<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Public Function
ConvertBitmapToGrayscale(ByVal sourceImage As Bitmap, Optional ByVal
formula As Formula = Formula.CCIRRec709) As Bitmap<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim
output As Bitmap = New Bitmap(sourceImage.Width, sourceImage.Height)<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim
rect As New Rectangle(0, 0, sourceImage.Width, sourceImage.Height)<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim cm As ColorMatrix<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim ia As New ImageAttributes<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Assign sourceBitmap to a new graphics object<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim g
As Drawing.Graphics = Drawing.Graphics.FromImage(output)<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Apply selected grayscale formula<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Select Case formula<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; Case Colors.Grayscale.Formula.CCIRRec709<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cm = New
ColorMatrix(New Single()() _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; {New Single()
{0.213, 0.213, 0.213, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New
Single() {0.715, 0.715, 0.715, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New
Single() {0.072, 0.072, 0.072, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New
Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0, 0,
0, 0, 1}})<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Case
Colors.Grayscale.Formula.NtscPal<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cm = New ColorMatrix(New
Single()() _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; {New Single() {0.299, 0.299,
0.299, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0.587, 0.587,
0.587, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0.114, 0.114,
0.114, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; Case Colors.Grayscale.Formula.SimpleAverage<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cm = New
ColorMatrix(New Single()() _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; {New Single()
{0.333, 0.333, 0.333, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New
Single() {0.333, 0.333, 0.333, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New
Single() {0.333, 0.333, 0.333, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New
Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0, 0,
0, 0, 1}})<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Case
Colors.Grayscale.Formula.WeightAverage<br>&nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cm = New ColorMatrix(New
Single()() _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; {New Single() {0.333, 0.333,
0.333, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0.444, 0.444,
0.444, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0.222, 0.222,
0.222, 0, 0}, _<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Case Else<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Use CCIR Rec. 709
as catch all<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; cm = New ColorMatrix(New Single()() _<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; {New Single() {0.213, 0.213, 0.213, 0, 0}, _<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; New Single() {0.715, 0.715, 0.715, 0, 0}, _<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; New Single() {0.072, 0.072, 0.072, 0, 0}, _<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; New Single() {0, 0, 0, 1, 0}, _<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
&nbsp;&nbsp; New Single() {0, 0, 0, 0, 1}})<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; End Select<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Set color matrix<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ia.SetColorMatrix(cm)<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Render new bitmap image<br>&nbsp;&nbsp;
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
g.DrawImage(sourceImage, rect, 0, 0, sourceImage.Width,
sourceImage.Height, GraphicsUnit.Pixel, ia)<br><br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ' Return converted image<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Return output<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp; &nbsp;&nbsp; End Class<br><br>End Namespace<br><br>&lt;/code&gt; <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1098365" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1098365/Complete-Grayscale-Class.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1098365" style="white-space: nowrap;">4.00/5 (3 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F1085519_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1085519xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1085519" href="http://www.codeproject.com/Messages/1085519/How-about-256-colored-pictures.aspx">How about 256-colored pictures</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1888975">offslinker</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">22:41 16 Apr '05 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1085519_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I try this on 256-colored pictures and have no result.<br>What can you advice me? <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1085519" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1085519/How-about-256-colored-pictures.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1085519" style="white-space: nowrap;">2.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F2566840_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34px"><a name="xx2566840xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2566840" href="http://www.codeproject.com/Messages/2566840/Re-How-about-256-colored-pictures-modified.aspx">Re: How about 256-colored pictures [modified]</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1338480">Luca Crisi, MCP</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">3:30 23 May '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2566840_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="34px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I noticed this on GIF pictures.<br>So,
I decided to promote the image, if it isn't in the Format32bppARGB
Pixel Format, to this Pixel Format, and it worked just fine.<br><br>That's the code I use:<br><br>&nbsp;&nbsp;&nbsp;&nbsp; Public Shared Function PictureConvertToRGB(ByVal bmp As Bitmap) As Bitmap<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Dim img As New Bitmap(bmp.Width, bmp.Height, _<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;  Imaging.PixelFormat.Format32bppArgb)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; img.SetResolution(bmp.HorizontalResolution, bmp.VerticalResolution)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Using gr As Graphics = Graphics.FromImage(img)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; gr.DrawImageUnscaled(bmp, 0, 0)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; End Using<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Return img<br>&nbsp;&nbsp;&nbsp;&nbsp; End Function<br><br>Give it a trial: it will surely work for you, too. <br><br>&lt;div class="ForumMod"&gt;modified on Monday, May 26, 2008 7:38 AM&lt;/div&gt;<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1085519" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/2566840/Re-How-about-256-colored-pictures-modified.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2566840" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F1072852_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16px"><a name="xx1072852xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1072852" href="http://www.codeproject.com/Messages/1072852/Hue-Saturation-and-Brightness.aspx">Hue, Saturation and Brightness...</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=1430886">AndrewVos</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">2:30 1 Apr '05 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1072852_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="16px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Any ideas on how to implement...<br>Currently working on a project which requires hue, looks as if this could do it, somehow!<br>Help would be greatly appreciated. <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1072852" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1072852/Hue-Saturation-and-Brightness.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1072852" style="white-space: nowrap;">1.25/5 (3 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="1px" width="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HiVote HdUnSel " id="F1352486_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34px"><a name="xx1352486xx"></a><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1352486" href="http://www.codeproject.com/Messages/1352486/Re-Hue-Saturation-and-Brightness.aspx">Re: Hue, Saturation and Brightness...</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="colormatrix.aspx_files/pin.gif" alt="Pin" align="top" border="0" height="12px" width="13px"></a></td><td style="width: 20px; white-space: nowrap;"><img src="colormatrix.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a href="http://www.codeproject.com/script/Membership/View.aspx?mid=183910">headspin</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">9:45 30 Jan '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1352486_h1" style="display: none;">
					<td width="100%"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img src="colormatrix.aspx_files/t_002.gif" alt="" height="1px" width="34px"></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">' Matrix Operations for Image Processing<br>' Converted from C to VB.NET By Headkaze (headkaze [at] gmail.com)<br>' Thanks to Paul Haeberli<br>' http://www.sgi.com/misc/grafica/matrix/<br><br>Option Explicit On <br>Option Strict On<br><br>Imports System.Drawing.Imaging<br><br>Module ColourProcessing<br>    Const RLUM As Single = 0.3086<br>    Const GLUM As Single = 0.6094<br>    Const BLUM As Single = 0.082<br><br>    ' MultiplyMatrix -	multiply two matricies<br>    Public Sub MultiplyMatrix(ByRef a As ColorMatrix, ByRef b As ColorMatrix, ByRef c As ColorMatrix)<br>        Dim x, y As Integer<br>        Dim temp As New ColorMatrix<br><br>        For y = 0 To 4<br>            For x = 0 To 4<br>                temp(y, x) = b(y, 0) * a(0, x) _<br>                            + b(y, 1) * a(1, x) _<br>                            + b(y, 2) * a(2, x) _<br>                            + b(y, 3) * a(3, x) _<br>                            + b(y, 4) * a(4, x)<br>            Next<br>        Next<br><br>        For y = 0 To 4<br>            For x = 0 To 4<br>                c(y, x) = temp(y, x)<br>            Next<br>        Next<br>    End Sub<br><br>    ' CreateIdentityMatrix - make an identity matrix<br>    Public Sub CreateIdentityMatrix(ByRef matrix As ColorMatrix)<br>        matrix = New ColorMatrix(New Single()() _<br>                                {New Single() {1, 0, 0, 0, 0}, _<br>                                New Single() {0, 1, 0, 0, 0}, _<br>                                New Single() {0, 0, 1, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>    End Sub<br><br>    ' Transform3dPointMatrix - transform a 3D point using a matrix<br>
Public Sub Transform3dPointMatrix(ByRef matrix As ColorMatrix, ByVal x
As Single, ByVal y As Single, ByVal z As Single, ByRef tx As Single,
ByRef ty As Single, ByRef tz As Single)<br>        tx = x * matrix(0, 0) + y * matrix(1, 0) + z * matrix(2, 0) + matrix(3, 0)<br>        ty = x * matrix(0, 1) + y * matrix(1, 1) + z * matrix(2, 1) + matrix(3, 1)<br>        tz = x * matrix(0, 2) + y * matrix(1, 2) + z * matrix(2, 2) + matrix(3, 2)<br>    End Sub<br><br>    ' ColourScaleMatrix - make a color scale matrix<br>
Public Sub ColourScaleMatrix(ByRef mat As ColorMatrix, ByVal rscale As
Single, ByVal gscale As Single, ByVal bscale As Single)<br>        Dim nmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {rscale, 0, 0, 0, 0}, _<br>                                New Single() {0, gscale, 0, 0, 0}, _<br>                                New Single() {0, 0, bscale, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(nmat, mat, mat)<br>    End Sub<br><br>    ' LuminanceMatrix - make a luminance matrix<br>    Public Sub LuminanceMatrix(ByRef mat As ColorMatrix)<br>        Dim rwgt, gwgt, bwgt As Single<br>        rwgt = RLUM<br>        gwgt = GLUM<br>        bwgt = BLUM<br>        Dim mmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {rwgt, rwgt, rwgt, 0, 0}, _<br>                                New Single() {gwgt, gwgt, gwgt, 0, 0}, _<br>                                New Single() {bwgt, bwgt, bwgt, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    ' SaturateMatrix - make a saturation matrix<br>    Public Sub SaturateMatrix(ByRef mat As ColorMatrix, ByVal sat As Single)<br>        Dim a, b, c, d, e, f, g, h, i As Single<br>        Dim rwgt, gwgt, bwgt As Single<br>        rwgt = RLUM<br>        gwgt = GLUM<br>        bwgt = BLUM<br>        a = CSng((1.0# - sat) * rwgt + sat)<br>        b = CSng((1.0# - sat) * rwgt)<br>        c = CSng((1.0# - sat) * rwgt)<br>        d = CSng((1.0# - sat) * gwgt)<br>        e = CSng((1.0# - sat) * gwgt + sat)<br>        f = CSng((1.0# - sat) * gwgt)<br>        g = CSng((1.0# - sat) * bwgt)<br>        h = CSng((1.0# - sat) * bwgt)<br>        i = CSng((1.0# - sat) * bwgt + sat)<br>        Dim mmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {a, b, c, 0, 0}, _<br>                                New Single() {d, e, f, 0, 0}, _<br>                                New Single() {g, h, i, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    ' OffsetMatrix - offset r, g, and b<br>    Public Sub OffsetMatrix(ByRef mat As ColorMatrix, ByVal roffset As Single, ByVal goffset As Single, ByVal boffset As Single)<br>        Dim mmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {1, 0, 0, 0, 0}, _<br>                                New Single() {0, 1, 0, 0, 0}, _<br>                                New Single() {0, 0, 1, 0, 0}, _<br>                                New Single() {roffset, goffset, boffset, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    ' XRotateMatrix - rotate about the x (red) axis<br>    Public Sub XRotateMatrix(ByRef mat As ColorMatrix, ByVal rs As Single, ByVal rc As Single)<br>        Dim mmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {1, 0, 0, 0, 0}, _<br>                                New Single() {0, rc, rs, 0, 0}, _<br>                                New Single() {0, -rs, rc, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    ' YRotateMatrix - rotate about the y (green) axis<br>    Public Sub YRotateMatrix(ByRef mat As ColorMatrix, ByVal rs As Single, ByVal rc As Single)<br>        Dim mmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {rc, 0, -rs, 0, 0}, _<br>                                New Single() {0, 1, 0, 0, 0}, _<br>                                New Single() {rs, 0, rc, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    ' ZRotateMatrix - rotate about the z (blue) axis<br>    Public Sub ZRotateMatrix(ByRef mat As ColorMatrix, ByVal rs As Single, ByVal rc As Single)<br>        Dim mmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {rc, rs, 0, 0, 0}, _<br>                                New Single() {-rs, rc, 0, 0, 0}, _<br>                                New Single() {0, 0, 1, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    ' ZShearMatrix - shear z using x and y.<br>    Public Sub ZShearMatrix(ByRef mat As ColorMatrix, ByVal dx As Single, ByVal dy As Single)<br>        Dim mmat As ColorMatrix = New ColorMatrix(New Single()() _<br>                               {New Single() {1, 0, dx, 0, 0}, _<br>                                New Single() {0, 1, dy, 0, 0}, _<br>                                New Single() {0, 0, 1, 0, 0}, _<br>                                New Single() {0, 0, 0, 1, 0}, _<br>                                New Single() {0, 0, 0, 0, 1}})<br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    ' HueRotateMatrix - rotate the hue, while maintaining luminance.<br>    Public Sub HueRotateMatrix(ByRef mat As ColorMatrix, ByVal rot As Single)<br>        Dim mmat As ColorMatrix<br>        Dim mag As Single<br>        Dim lx, ly, lz As Single<br>        Dim xrs, xrc As Single<br>        Dim yrs, yrc As Single<br>        Dim zrs, zrc As Single<br>        Dim zsx, zsy As Single<br><br>        CreateIdentityMatrix(mmat)<br><br>        ' rotate the grey vector into positive Z<br>        mag = CSng(Math.Sqrt(2.0))<br>        xrs = CSng(1.0# / mag)<br>        xrc = CSng(1.0# / mag)<br>        XRotateMatrix(mmat, xrs, xrc)<br>        mag = CSng(Math.Sqrt(3.0#))<br>        yrs = CSng(-1.0# / mag)<br>        yrc = CSng(Math.Sqrt(2.0#) / mag)<br>        YRotateMatrix(mmat, yrs, yrc)<br><br>        ' shear the space to make the luminance plane horizontal<br>        Transform3dPointMatrix(mmat, RLUM, GLUM, BLUM, lx, ly, lz)<br>        zsx = lx / lz<br>        zsy = ly / lz<br>        ZShearMatrix(mmat, zsx, zsy)<br><br>        ' rotate the hue<br>        zrs = CSng(Math.Sin(rot * Math.PI / 180.0#))<br>        zrc = CSng(Math.Cos(rot * Math.PI / 180.0#))<br>        ZRotateMatrix(mmat, zrs, zrc)<br><br>        ' unshear the space to put the luminance plane back<br>        ZShearMatrix(mmat, -zsx, -zsy)<br><br>        ' rotate the grey vector back into place<br>        YRotateMatrix(mmat, -yrs, yrc)<br>        XRotateMatrix(mmat, -xrs, xrc)<br><br>        MultiplyMatrix(mmat, mat, mat)<br>    End Sub<br><br>    Public Function DrawImageWithMatrix(ByVal img As Image, ByVal cm As ColorMatrix) As Boolean<br>        Try<br>            Dim bmp As New Bitmap(img) ' create a copy of the source image <br>            Dim imgattr As New ImageAttributes<br>            Dim rc As New Rectangle(0, 0, img.Width, img.Height)<br>            Dim g As Graphics = Graphics.FromImage(img)<br><br>            ' associate the ColorMatrix object with an ImageAttributes object<br>            imgattr.SetColorMatrix(cm)<br><br>            ' draw the copy of the source image back over the original image, <br>            'applying the ColorMatrix<br>            g.DrawImage(bmp, rc, 0, 0, img.Width, img.Height, GraphicsUnit.Pixel, imgattr)<br><br>            g.Dispose()<br><br>            Return True<br>        Catch<br>            Return False<br>        End Try<br>    End Function<br>End Module<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fGDI-plus%2fcolormatrix.aspx">Sign In</a>·<a class="Frm_MHL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1072852" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="Frm_MHL" href="http://www.codeproject.com/Messages/1352486/Re-Hue-Saturation-and-Brightness.aspx" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1352486" style="white-space: nowrap;">5.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr>
					<td><img src="colormatrix.aspx_files/t_002.gif" alt="" border="0" height="5px" width="1px"></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><table cellpadding="2px" cellspacing="0" width="100%">
				<tbody><tr class="Frm_Footer">
					<td>Last Visit: 21:40 2 Dec '09  &nbsp; &nbsp; Last Update: 21:40 2 Dec '09 </td><td style="text-align: right; white-space: nowrap;"><input id="_mbnUrl" value="/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26" type="hidden"><b>1</b><a class="Frm_HL" name="Frm_HoverNL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx">2</a><a class="Frm_HL" name="Frm_HoverNL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=51#xx0xx">3</a> <a class="Frm_HL" name="Frm_HoverNL" href="http://www.codeproject.com/KB/GDI-plus/colormatrix.aspx?fid=14842&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx">Next »</a></td>
				</tr>
			</tbody></table></td>
		</tr>
	</tbody></table>
</div><p class="SmallText"><img src="colormatrix.aspx_files/msg_general.gif" alt="General" align="top" height="16px" width="16px"> General &nbsp;&nbsp; <img src="colormatrix.aspx_files/msg_news.gif" alt="News" align="top" height="16px" width="16px"> News &nbsp;&nbsp; <img src="colormatrix.aspx_files/msg_question.gif" alt="Question" align="top" height="16px" width="16px"> Question &nbsp;&nbsp; <img src="colormatrix.aspx_files/msg_answer.gif" alt="Answer" align="top" height="16px" width="16px"> Answer &nbsp;&nbsp; <img src="colormatrix.aspx_files/msg_joke.gif" alt="Joke" align="top" height="16px" width="16px"> Joke &nbsp;&nbsp; <img src="colormatrix.aspx_files/msg_rant.gif" alt="Rant" align="top" height="16px" width="16px"> Rant &nbsp;&nbsp; <img src="colormatrix.aspx_files/msg_admin.gif" alt="Admin" align="top" height="16px" width="16px"> Admin &nbsp;&nbsp; </p>
<!-- Forum End -->




	
	</div>
	
	
	
	<table width="100%">
	<tbody><tr valign="top">
		<td class="TinyText" align="left">
		    <a id="ctl00_PermaLink" href="http://www.codeproject.com/script/Articles/Article.aspx?aid=3772">PermaLink</a> | 
			<a id="ctl00_PrivacyLink" href="http://www.codeproject.com/info/privacy.aspx">Privacy</a> |
			<a id="ctl00_TermsOfUseLink" href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a>
			<br>Last Updated: 2 Apr 2003<br>
			Editor: <a id="ctl00_ArticleEditor" href="http://www.codeproject.com/script/Membership/View.aspx?mid=28970">Smitha Vijayan</a><br>
		</td>
		<td class="TinyText" align="right" valign="top">
			Copyright 2003 by Michael Combs<br>Everything else
			Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2009 <br>
			Web15 |
			<a id="ctl00_AdvertiseLink" href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on the Code Project </a>
		</td>
	</tr>
	
	</tbody></table>
	
	<center>
		
	</center>

</div>
</div>	
	
<div>


</div>

<br>
<script type="text/javascript" language="Javascript" src="colormatrix.aspx_files/oncopy.js"></script>
<script type="text/javascript" language="Javascript" src="colormatrix.aspx_files/TogglePre.js"></script>
<script type="text/javascript" language="Javascript" src="colormatrix.aspx_files/JobsSummaryRetriever.js"></script>
<script type="text/javascript" language="Javascript" src="colormatrix.aspx_files/addto.js"></script>
<script type="text/javascript" language="Javascript" src="colormatrix.aspx_files/rateitem.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
var e=document;
if(e){if(document.all)try{e.attachEvent('onkeydown',LK);}catch(ex){} 
else e.addEventListener('keydown',LK, false);}

var e=document;
if(e){if(document.all)try{e.attachEvent('onkeyup',LK);}catch(ex){} 
else e.addEventListener('keyup',LK, false);}

var e=document;
if(e){if(document.all)try{e.attachEvent('onblur',LK);}catch(ex){} 
else e.addEventListener('blur',LK, false);}

var e=document.getElementById('ctl00_TopNavBar_Lounge');
if(e){if(document.all)try{e.attachEvent('onclick',LC);}catch(ex){} 
else e.addEventListener('click',LC, false);}

var e=document.getElementById('ctl00_TopNavBar_Soapbox');
if(e){if(document.all)try{e.attachEvent('onclick',LC);}catch(ex){} 
else e.addEventListener('click',LC, false);}

$(document).ready(function() {RetrieveJobsSummary('Th',3772,2,225,"83,94,98,103,118,152");});
var socialLinks = new social();
socialLinks.PlaceholderId="ATD";socialLinks.ObjectId=3772;
socialLinks.ObjectTypeId=2;
socialLinks.addtoMethod=1;
socialLinks.Horizontal=false;
socialLinks.Showname=true;
socialLinks.setupLinks("socialLinks", document.location.href,escape(document.title), 100, 0, "SmallText Bold", "AddTo");
socialLinks.setupMenu();
$('#ctl00_RateArticle_RateItemWrapper').css('display', '');

//]]></script>

</body></html>